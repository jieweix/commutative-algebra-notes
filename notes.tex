\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage[all]{xy}
\usepackage{color}
\usepackage{geometry}
\usepackage{stmaryrd}
\usepackage{hyperref}

\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother


\SelectTips{eu}{}
\setlength{\fboxsep}{0pt}
\setlength\parskip{0.3em}
\setlength{\parindent}{0 pt}

\newcommand{\la}{\left\langle}
\newcommand{\ra}{\right\rangle}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\C}{\mathbb C}
\newcommand{\m}{\mathfrak m}
\newcommand{\ass}{\text{ass}}
\newcommand{\ann}{\text{ann}}
\newcommand{\In}{\text{in}}
\newcommand{\End}{\text{End}}
\newcommand{\adj}{\text{adj}\ }
\newcommand{\lcm}{\text{lcm}\ }
\newcommand{\id}{\text{id}}
\newcommand{\im}{\text{im }}
\newcommand{\spanset}{\text{span}}
\newcommand{\rank}{\text{rank }}
\newcommand{\Mod}{\text{ mod }}
\newcommand{\Spec}{\text{Spec}}

\theoremstyle{definition}

\newtheorem{defn}{Definition}[subsection]
\newtheorem{prop}[defn]{Proposition}
\newtheorem{thm}[defn]{Theorem}
\newtheorem{lemma}[defn]{Lemma}
\newtheorem{coro}[defn]{Corollary}
\newtheorem{example}[defn]{Example}
\newtheorem{axiom}[defn]{Axiom}
\newtheorem{exe}[defn]{Exercise}
\newtheorem*{remark}{Remark}
\newtheorem*{notation}{Notation}

\title{MA3G6 Commutative algebra :: Lecture notes}
\author{Lecturer: Diane Maclagan}
\date{\today}

\begin{document}

\maketitle
\thispagestyle{empty}

\tableofcontents
\thispagestyle{empty}
\newpage
\setcounter{page}{1}

\begin{flushright}
\textit{Week 1, lecture 1 starts here}
\end{flushright}

What is this module about?
\begin{itemize}
\item Continuation of MA249,
\item Back engine for algebraic geometry and (algebraic) number theory,
\item Connection to other areas (combinatorics, applied maths, ...),
\item Fun in its own right.
\end{itemize}

\section*{Recall}
\begin{defn}
A \textit{ring} $(R,+,\times)$ is a set $R$ with binary operations $+:R\times R\rightarrow R,\ \times:R\times R\rightarrow R$ such that
\begin{enumerate}
\item $(R,+)$ is an abelian group (identity denoted $0_R$ or given clear context simply 0),
\item $\times$ is associative and distributes over $+$,
\item $\exists 1_R\in R:1_R\cdot a = a\cdot 1_R=a\ \forall a \in R$.
\end{enumerate}
\end{defn}
Within context of this module, we always add a 4th axiom:
\begin{enumerate}
\item[4.] $ab=ba \ \forall a,b\in \mathbb R$ \qquad commutativity
\end{enumerate}

\begin{example}
\begin{itemize}
\item $\Z$
\item Polynomial ring
\item $S=\C[x_1,\ldots,x_n]$, $\displaystyle f\in S,\ f=\sum_{u\in \mathbb N^n} c_u x^u$, $c_u\in \C,\ x^u=x_1^{u_1} x_2^{u_2} \cdots x_n^{u_n}$ (this is called multiindex notation) and only finitely many $c_u\neq 0$. e.g. $x_1 x_3 + 7x_2\in \C[x_1,x_2,x_3]$ is written as $x^{(1,0,1)}+7x^{(0,2,0)}$. One can also replace $\C$ with any field.
\end{itemize}
\end{example}
\begin{defn}
A \textit{ring homomorphism} is a function $\varphi:R\rightarrow S$ where $R,S$ rings that respects addition and multiplication: $\varphi(a+b)=\varphi(a)+\varphi(b),\ \varphi(ab)=\varphi(a)\varphi(b)$ and $\varphi(1_R)=1_S$.
\end{defn}
The definition implies that homomorphisms preserve 0.

\begin{defn}
The \textit{kernel} of a homomorphism $\varphi$ is $\ker (\varphi) = \{a\in R:\varphi(a)=0_S\}$.
\end{defn}

\begin{defn}
A nonempty $I\subseteq R$ is an \textit{ideal} if $a,b\in I \Rightarrow a+b\in I$ and $a\in I,r\in R\Rightarrow ra\in I$.
\end{defn}

It immediately follows from the definition that kernel of $\varphi:R\rightarrow S$ is an ideal of $R$.

\begin{example}
$\varphi:\Z \rightarrow \Z/5\Z$ by $\varphi(n) = n\Mod 5$.
\end{example}

\begin{defn}
We say $I$ is \textit{generated} by $f_1,\ldots,f_s\in R$ if
\[
I=\left\{\sum_{i=1}^s h_i f_i : h_i\in R \right\} =: \la f_1,\ldots,f_s\ra
\]
More generally, $I$ is generated by $G\subseteq R$ if
\[
I=\left\{\sum_{i=1}^s h_i f_i : h_i\in R, f_i\in G,s\geq 0 \right\}.
\]
\end{defn}
This is closed under addition and multiplication by an element of $R$, hence an ideal.

\begin{flushright}
\textit{Week 1, lecture 2 starts here}
\end{flushright}

\section{Gröbner basis}
\begin{example}[Motivating questions]
\begin{enumerate}
\item Is $14\in \la 6,26\ra \subseteq Z$? Yes, since $14=-2\times 6+26$.

Do note that $\Z$ is a PID, and $\la 6,26\ra=\la 2 \ra$ where $2=\gcd(6,26)$.
\item Is $x+7\in \la x^2-4x+3, x^2+x-2\ra \subseteq \Z[x]$? No, since $x^2-4x+3=(x-1)(x-3)$ and $x^2+x-2=(x-1)(x+2)$, and $x-1\nmid x+7$.
\item Is $x+3y-2z \in \la x+y-z, y-z\ra$? No, since any linear combination of the two generators have same coefficients for $y$ and $z$. In linear algebra jargon, $(1,3,-2)$ is not in rowspace of $\begin{pmatrix}1 & 1 & -1 \\ 0 & 1 & -1 \end{pmatrix}$.
\end{enumerate}
We do have enough specific knowledge to solve these, but not their general forms.
\end{example}
\begin{example}
Is $xy^2-x\in \la xy+1,y^2-1\ra$?

If we were not careful, we would try to divide $xy^2-x$ by $xy+1$ which leads to $xy^2-x=y(xy+1)+(-x-y)$, a dead end. But note that $xy^2-x=x(y^2-1)$, which means it is in the ideal.

We now want to know how we can be `careful'.
\end{example}
\begin{defn}
A \textit{term order} (or monomial order) is a total order on monomials $x^u$ in $S=K[x_1,\ldots,x_n]$ (where $K$ is a field) such that
\begin{enumerate}
\item $1\prec x^u \ \forall u\neq 0$
\item $x^u\prec x^v \Rightarrow x^{u+w}\prec  x^{v+w} \ \forall u,v,w,\in \mathbb N^n$
\end{enumerate}
\end{defn}
\begin{example}
\begin{enumerate}
\item Lexicographic term order: $x^u\prec x^v$ if the first nonzero element of $v-u$ is positive.

e.g. $x_2^2\prec x_2^{10}\prec x_1x_3\prec x_1^2$. We can write them in multiindex notation:
\[
x^{(0,2,0)},x^{(0,10,0)},x^{(1,0,1)},x^{(2,0,0)},
\]
and the result is clear. This is analogous to how we order words in a dictionary.
\item Degree lexicographic order: $x^u\prec x^v$ if $\deg(x^u)<\deg(x^v)=v_1+\ldots +v_n$, or if they are equal, $x^u\prec_{\text{lex}} x^v$. e.g. $x_2^2\prec x_1x_3\prec x_1^2\prec x_2^{10}$.
\item (Degree) reverse lexicographic order (revlex): $x^u\prec x^v$ if $\deg(x^u)<\deg(x^v)=v_1+\ldots +v_n$, or if they are equal, the last nonzero entry of $v-u$ is negative. e.g. $x_1x_3\prec x_2^2\prec x_1^2\prec x_2^{10}$.
\end{enumerate}
\end{example}

\begin{defn}
Fix a term order $\prec$ on $K[x_1,\ldots,x_n]$. The \textit{initial term} $\In_\prec (f)$ of a polynomial $f=\sum c_u x^u$ is $c_v x^v$ if $x^v=\max_\prec \{x^u:c_u\neq 0\}$.
\end{defn}

\begin{example}
Let $f=3x^2-8xz^9+9y^{10}$. Then
\begin{itemize}
\item If $\prec=\text{lex}$, $\In_\prec(f)=3x^2$
\item If $\prec=\text{deglex}$, $\In_\prec(f)=-8xz^9$
\item If $\prec=\text{revlex}$, $\In_\prec(f)=9y^{10}$
\end{itemize}
\end{example}

\begin{defn}
Let $I\subseteq S$ be an ideal. The \textit{initial ideal} of $I$ is $\In_\prec (I) := \la \In_\prec(f):f\in I\ra$.  
\end{defn}
\begin{remark}
If $I=\la f_1,\ldots,f_s\ra$ then $\la \In_\prec (f_1),\ldots,\In_\prec (f_s)\ra \subseteq \In_\prec(I)$, but not necessarily equal.

\begin{example}
\label{example:GBcounterexample}
$I=\la x+y+z, x+2y+3z\ra$. Then $\In_\prec (f_1)=\In_\prec (f_2)=x$, so $\la \In_\prec (f_1) \In_\prec (f_2) \ra=\la x\ra$, but $y+2z\in I,\ \In_\prec(y+2z)=y\not\in \la x\ra$.
\end{example}
\end{remark}

\begin{defn}
A set $\{g_1,\ldots,g_s\}\subseteq I$ is a \textit{Gröbner basis} for $I$ if $\In_\prec (I)=\la \In_\prec (g_1),\ldots,\In_\prec (g_s)\ra$.
\end{defn}
With this language, we can express Example \ref{example:GBcounterexample} by saying `$\{x+y+z,x+2y+3z\}$ is not a Gröbner basis of the ideal'. We will see that every ideal in $S$ has a Gröbner basis, and long division using a Gröbner basis solves the ideal membership problem ($f\in I$ iff the remainder on dividing by the Gröbner basis is 0).

\begin{flushright}
\textit{Week 2, lecture 1 starts here}
\end{flushright}

\subsection{Division algorithm}
Let $S=K[x_1,\ldots,x_n]$.
\begin{itemize}
\item Input: $f_1,\ldots,f_s,f\in S$ and $\prec$ the term order
\item Output: an expression $f=\sum_{i=1}^s h_i f_i+r$, where
\begin{enumerate}
\item $h_i,r\in S,\ r=\sum c_u x^u$
\item If $c_u\neq 0$, then $x^u$ is not divisible by any $\In_\prec (f_i)$
\item If $\In_\prec(f)=c_u x^u,\ \In_\prec(h_i f_i)=c_{v_i}x^{v_i}$ then $x^u\succeq x^{v_i} \ \forall i$
\end{enumerate}
\item The algorithm:\begin{enumerate}
\item Initialize: $h_1,\ldots,h_s=0,\ r=0,\ p=f,\ f=p+\sum h_i f_i+r$.
\item Loop: At each stage, if $\In_\prec(p)$ is divisible by some $\In_\prec(f_i)$, subtract $\frac{\In_\prec(p)}{\In_\prec(f_i)}f_i$ from $p$ and add $\frac{\In_\prec(p)}{\In_\prec(f_i)}$ to $h_i$.

If $\In_\prec(p)$ is not divisible by any $\In_\prec(f_i)$, subtract it from $p$ and add it to $r$.
\item Termination: stop when $p=0$ and output $h_1,\ldots,h_s,r$.
\end{enumerate}
\end{itemize}
\begin{example}
$f=\underline{x}+2y+3z,\ f_1=\underline{x}+y+z,\ f_2=\underline{5y}+3z$, term order is $\prec_{\text{lex}}$ and $x\succ y\succ z$.
\begin{enumerate}
\item Initialize: $h_1=h_2=r=0,\ p=x+2y+3z$
\item 1st loop: The underlined are initial terms, and $\In_\prec(p)=x$ is divisible by $\In_\prec(f_1)=x$, so
\[
p=p-\frac{\In_\prec(p)}{\In_\prec(f_1)}f_1=x+2y+3z-(x+y+z)=y+2z
\]
and $h_1=0+\frac{\In_\prec(p)}{\In_\prec(f_1)}=1$.
\item 2nd loop: $\In_\prec(p)=y$ is divisible by $\In_\prec(f_2)=5y$, so
\[
p=p-\frac{\In_\prec(p)}{\In_\prec(f_2)}f_2=y+2z-\frac15 (5y+3z)=\frac75 z
\]
and $h_2=0+\frac{\In_\prec(p)}{\In_\prec(f_2)}=\frac15$.
\item Termination: $\In_\prec(p)=\frac75 z$ is not divisible by any $\In_\prec(f_i)$, so
\[
p-\In_\prec(p)=0,\ r=\In_\prec(p)=\frac75 z
\]
and we have the expression
\[
x+2y+3z=1(x+y+z)+\frac15 (5y+3z) + \frac75 z.
\]
\end{enumerate}
\end{example}
\begin{example}
Divide $f=x^2$ by $f_1=x+y+z$ and $f_2=y-z$ with $\prec_\text{lex}$ and $x\succ y\succ z$.
\begin{enumerate}
\item $h_1=h_2=r=0,\ p=f=x^2$
\item $p=p-\frac{\In_\prec(p)}{\In_\prec(f_1)}f_1=x^2-\frac{x^2}{x}(x+y+z)=-xy-xz,\ h_1=0+x=x$
\item $p=p-\frac{\In_\prec(p)}{\In_\prec(f_1)}f_1=-xy-xz-(-y)(x+y+z)=-xz+y^2+yz,\ h_1=h_1-y=x-y$
\item $p=p-\frac{\In_\prec(p)}{\In_\prec(f_1)}f_1=-xz+y^2+yz+z(x+y+z)=y^2+2yz+z^2,\ h_1=h_1-z=x-y-z$
\item $p=p-\frac{\In_\prec(p)}{\In_\prec(f_2)}f_2=y^2+2yz+z^2-y(y-z)=3yz+z^2,\ h_2=0+y=y$
\item $p=p-\frac{\In_\prec(p)}{\In_\prec(f_2)}f_2=3yz+z^2-3z(y-z)=4z^2,\ h_2=h_2+3z=y+3z$
\item $4z^2$ not divisible by any $\In_\prec(f_i)$, so terminate. $p=p-\In_\prec(p),\ r=\In_\prec(p)$, output $h_1=x-y-z,\ h_2=y+3z,\ r=4z^2$, and check:
\[
x^2=(x-y-z)(x+y+z)+(y+3z)(y-z)+4z^2.
\]
\end{enumerate}
\end{example}
The coming punchline is that if $f_i$'s are a Gröbner basis then remainder $r$ is unique.

\begin{lemma}
\label{lemma:monomialIdealDivisible}
Let $I=\la x^u:u\in A\ra$ for some $A\subseteq \mathbb N^n$, then
\begin{enumerate}
\item $x^v\in I$ iff $x^u\mid x^v$ for some $u\in A$
\item if $f=\sum c_v x^v\in I$, then each $x^v$ is divisible by $x^u$ for some $u\in A$
\end{enumerate}
\end{lemma}

\begin{prop}
If $\{g_1,\ldots,g_s\}$ is a Gröbner basis for $I$ with respect to $\prec$, then $f\in I$ iff the division algorithm dividing $f$ by $g_1,\ldots,g_s$ gives remainder 0.
\end{prop}
\begin{proof}
\begin{itemize}
\item[$\Rightarrow$] Division algorithm writes $f=\sum h_i g_i+r$, so if $r=0$ we have $f\in I$.
\item[$\Leftarrow$] We prove the contrapositive: suppose $r\neq 0$. If $f\in I$ then $r\in I$, so $\In_\prec(r)\in \In_\prec(I)$. But by construction, $\In_\prec(r)$ is not divisible by $\In_\prec(g_i)$ for any $i$. This contradicts that $\In_\prec(I)=\la \In_\prec(g_1),\ldots,\In_\prec(g_s)\ra$.
\end{itemize}
\end{proof}

\begin{flushright}
\textit{Week 2, lecture 2 starts here (Chunyi Li)}
\end{flushright}

\section{Noetherian ring}
\begin{defn}
A ring $R$ is \textit{Noetherian} if every ideal of $R$ is finitely generated.
\end{defn}

\begin{example}
\label{example:noetherian}
\begin{enumerate}
\item $\mathbb R$ and $\C$ are fields, so they only have two ideals $\la 0\ra,\la 1\ra$, so Noetherian.
\item $\Z$ and $\C[x]$ are principal ideal domains, this implies they are Noetherian.
\item $\C[x,y]$ and $\Z[x]$?
\item $R:=\{f:\mathbb R\rightarrow\mathbb R:f\text{ continuous}\}$, probably not?
\item $\C[x_1,\ldots,x_n,\ldots]=\bigcup_{n=1}^{\infty} \C[x_1,\ldots,x_n]$, a polynomial ring which has infinite variables but finite nonzero terms.
\end{enumerate}
\end{example}

\begin{defn}
A ring $R$ satisfies \textit{ascending chain condition} (ACC) if every chain of ideals $I_1\subseteq I_2\subseteq \cdots \subseteq I_n\subseteq \cdots$ eventually stabilizes, i.e. $\exists n\in\mathbb N:I_m=I_n \ \forall m\geq n$, i.e. $\nexists$ strictly ascending chain of ideals $I_1\subsetneqq I_2\subsetneqq \cdots \subsetneqq I_n \subsetneqq \cdots$.
\end{defn}
\begin{prop}
$R$ is Noetherian iff $R$ satisfies ACC.
\end{prop}
\begin{proof}
\begin{itemize}
\item[$\Rightarrow$] Let $I_1\subseteq I_2\subseteq \cdots \subseteq I_n\subseteq \cdots \lhd R$ and consider $J=\bigcup_{k=1}^\infty I_k$. Note $\forall r,s\in J,\ r\in I_j,\ s\in I_t$. WLOG assume $j\leq t$, then $r,s\in I_t$ and $r\pm s\in I_t\subset J$, and more generally $J\lhd R$. Since $J$ is finitely generated, we write $J=\la f_1,\ldots,f_m\ra$. By definition $f_i\in I_{n_i}$, so $\exists N:f_i\in I_N \ \forall i$, implying $J\subseteq I_N$. But $J$ is already the union of all ideals, so the chain must stabilize at $I_N$.

\item[$\Leftarrow$] Let $I\lhd R$ and suppose $I$ is not finitely generated. We know $\exists f_1\neq 0\in I$ and $I\neq \la f_1\ra$, also $\exists f_2\in I\backslash \la f_1\ra$ and $I\neq \la f_1,f_2\ra$. We can keep doing this and in general
\[
\exists f_{n+1}\subset I\backslash \la f_1,\ldots,f_n\ra \Rightarrow I\neq \la f_1,\ldots,f_{n+1}\ra \quad \forall n\in \mathbb N
\]
This gives us a strictly ascending chain $\la f_1\ra \subsetneqq \la f_1,f_2\ra \subsetneqq \cdots \subsetneqq \la f_1,\ldots,f_n\ra \subsetneqq \cdots$ which is a contradiction.
\end{itemize}
\end{proof}
\begin{example}
\begin{enumerate}
\item We now know the 4th of Example \ref{example:noetherian} is not Noetherian, since
\[
\la \sin x\ra \subsetneqq \la \sin \frac{x}{2}\ra \subsetneqq \la \sin \frac{x}{4}\ra \subsetneqq \cdots \subsetneqq \la \sin \frac{x}{2^n}\ra \subsetneqq \cdots
\]
is a strictly ascending chain or ideals.
\item Also,
\[
\la x_1\ra \subsetneqq \la x_1,x_2\ra \subsetneqq \cdots\subsetneqq \la x_1,\ldots,x_n\ra \subsetneqq \cdots
\]
so the 5th is also not Noetherian.
\end{enumerate}
\end{example}
\begin{thm}[1st isomorphism theorem]
Let $R,S$ be rings. If $\varphi : R\rightarrow S$ is a ring homomorphism then $\im \varphi\cong R/\ker \varphi$. If $\varphi$ is surjective then $\im \varphi=S$ so we have $S\cong R/\ker \varphi$.

$\forall I\lhd R,\ R/I$ is a ring, and there is a natural surjective homomorphism $\varphi:R\rightarrow R/I$ defined by $r\mapsto r+I$. Note that $I=\ker\varphi$, so this is a isomorphism.
\end{thm}
\begin{thm}[4th isomorphism theorem]
For the same $\varphi$ as above, there is a 1-1 correspondence
\[
\varphi^{-1}:\{J\lhd R/I\} \rightarrow \{\widetilde J \lhd R: J\supseteq I\lhd R\}.
\]
\end{thm}
\begin{prop}
If $R$ is Noetherian then $R/I$ is Noetherian $\forall I\lhd R$.
\end{prop}

\begin{flushright}
\textit{Week 2, lecture 3 starts here}
\end{flushright}

\begin{proof}
Suppose $\exists J_1\subsetneqq \cdots \subsetneqq J_n\subsetneqq\cdots\lhd R/I$. Then by 4th isomorphism theorem,
\[
\exists \varphi^{-1}(J_1)\subsetneqq \cdots \subsetneqq \varphi^{-1}(J_n)\subsetneqq\cdots \lhd R,
\]
a contradiction.
\end{proof}
\begin{thm}[Hilbert basis theorem]
If $R$ is Noetherian then $R[x]$ is Noetherian.
\end{thm}
\begin{proof}[Proof (nonexaminable)]
Let $I\lhd R[x]$. Suppose $I$ is not finitely generated. $\exists f_1\in I$ with the minimal degree such that $I\neq \la f_1\ra$. Now choose $f_2\in I\backslash\la f_1\ra$ with the minimal degree so that $I\neq\la f_1,f_2\ra$. We proceed inductively and have
\[
\exists f_{n+1}\in I\backslash\la f_1,\ldots,f_n\ra \text{ with minimal degree so that } I\neq \la f_1,\ldots,f_{n+1}\ra.
\]
For every $f_i$ we can write $f_i=r_i x^{n_i}+$lower degree terms and $n_1\leq n_2\leq\cdots n_m\leq \cdots$. We now claim that
\[
\la r_1\ra \subsetneqq\la r_1,r_2\ra\subsetneqq\cdots\subsetneqq\la r_1,\ldots,r_m\ra \subsetneqq\cdots
\]
is a strictly ascending chain of ideals in $R$, which gives a contradiction. To see this, suppose $r_{m+1}\in\la r_1,\ldots,r_m\ra$, i.e.
\[
r_{m+1}=s_1 r_1+\cdots+s_m r_m \quad \text{for some } s_1,\ldots, s_m\in R,
\]
Now consider
\[
\widetilde f_{m+1}(x):=f_{m+1}(x)-s_1 x^{n_{m+1}-n_1} f_1(x) - s_2 x^{n_{m+1}-n_2} f_2(x) - \cdots - s_m x^{n_{m+1}-n_m} f_m(x),
\]
whose leading terms cancel and $\deg \widetilde f_{m+1}<\deg f_{m+1}$. But $\widetilde f_{m+1}$ still satisfies that it's not in $\la f_1,\ldots,f_m\ra$, contradicting the minimality of $\deg f_{m+1}$.
\end{proof}
\begin{coro}
If $R$ is Noetherian then $R[x_1,\ldots,x_n]$ is Noetherian.
\end{coro}
\begin{proof}
One knows $R[x]$ is Noetherian. Now assume $R[x_1,\ldots,x_m]$ is Noetherian. Then
\[
R[x_1,\ldots,x_{m+1}]=(R[x_1,\ldots,x_m])[x_{m+1}]
\]
is Noetherian, so by induction one has what's desired.
\end{proof}
\begin{example}
\begin{enumerate}
\item $\Z$ is a PID, so Noetherian, so $\Z[x]$ is Noetherian.
\item $\Z[\sqrt 5]\cong \Z[x]/\la x^2-5\ra$ is Noetherian.
\item $\Z[\sqrt 5,\sqrt[4] 7]\cong\Z[x,y]/\la x^2-5,x^4-7\ra$ is Noetherian.
\item We have already seen that all fields are Noetherian, and any ring is a subring of its field of fractions. So it's not true that a subring of a Noetherian ring is Noetherian.
\end{enumerate}
\end{example}
\begin{defn}
An ideal $I\lhd R$ is \textit{prime} if
\begin{enumerate}
\item $I\neq R$
\item $\forall fg\in I,\ f$ or $g\in I$
\end{enumerate}
\end{defn}
\begin{example}
In $\Z$, $\la p\ra$ where $p$ prime is a prime ideal by Euclid's lemma. Also $\la 0\ra$ is prime, but $\la 1\ra$ is not since it's the whole ring.
\end{example}

\begin{flushright}
\textit{Week 3, lecture 1 starts here}
\end{flushright}

\subsection{Every ideal $I$ in $\C[x_1,\ldots,x_n]$ has a finite Gröbner basis}

\begin{proof}[Proof of Lemma \ref{lemma:monomialIdealDivisible}]
Note that 1 is a special case of 2, so it suffices to prove the latter.

If $f\in I$ write $f=\sum c_v x^v = \sum_{u\in A} h_u x^u$ with only finitely many $h_u\neq 0$. We expand the RHS as a sum of monomials, each monomial is divisible by some $x^u$ with $u\in A$. Hence the same is true for $x^v$ with $c_v\neq 0$ since these are terms remaining after cancellation.
\end{proof}

\begin{thm}[Dickson's lemma]
Let $I=\la x^u:u\in A\ra \subseteq S=K[x_1,\ldots,x_n]$ for some $A\subseteq \mathbb N^n$. Then $\exists a_1,\ldots,a_s\in A$ with $I=\la x^{a_1},\ldots,x^{a_s} \ra$.
\end{thm}
Before diving into the proof let's think about two special cases.
\begin{itemize}
\item[$n=1$] Consider $I=\la x_1^3,x_1^7,x_1^{70000},x_1^{1234},\ldots\ra$. One can see that $x_1^3$ is sufficient to generate the whole $I$.
\item[$n=2$] Consider $u,v\in\mathbb N^2$ as points on a lattice grid. Then $x^u$ is divisible by $x^v$ if it's top right of it, so we can get rid of unnecessary ones in a similar fashion.
\end{itemize}
Now let's turn these intuitions into a general proof.
\begin{proof}[Proof by induction]
Straightforwardly, when $n=1,\ I=\la x_1^{\alpha_1}\ra$ for $\alpha=\min \{j:x_j^I \}$. Now assume $n>1$ and the theorem is true for $n-1$.

Write the variables in $S$ as $x_1,\ldots,x_{n-1},y$ and let $I$ be an ideal in $S$. Let $J=\la x^u:x^uy^c\in I\text{ for some }c\geq 0\ra\subseteq K[x_1,\ldots,x_{n-1}]$. By inductive hypothesis, $J$ is finitely generated, so write $J=\la x^{a_{m_1}}, \ldots, x^{a_{m_r}}\ra $ for $x^{a_{m_i}}y^{m_i}\in I$.

Let $m=\max \{m_i\}$. For $0\leq l\leq m-1$, let $J_l=\la x^u:x^u y^l\in I\ra\subseteq K[x_1,\ldots,x_{n-1}]$. Again $J_l$ is finitely generated and write $J_l=\la x^{a_{j_1}},\ldots,x^{a_{j_{r_l}}}\ra$. We claim that $I$ is generated by $\{x^{a_{m_i}} y^{m_i}:1\leq i\leq r\} \cup \{x^{a_{j_i}}y^{j} : 1\leq j\leq m-1,\ 1\leq i\leq r_j\}$. Indeed, if $x^u y^j\in I$ then either
\begin{enumerate}
\item $j<m$, so $x^u\in J_j$, so  $x^{j_i} \mid x^u$ for some $i$, and so $x^{a_{j_i}} y^j\mid x^u y^j$.
\item $j\geq m$, so $x^u\in J$, so $x^{a_{m_i}} \mid x^u$ for some $i$, and so since $m_i\leq m,\ x^{a_{m_i}} y^{m_i}\mid x^u y^j$.
\end{enumerate}
So every monomial in $I$ is a multiple of one of the claimed generators.

If any of these generators is not in our original set $A$, we can replace it by a monomial with exponent in $A$, and by Lemma \ref{lemma:monomialIdealDivisible} if they generate all monomials then they generate the whole $I$.
\end{proof}

\begin{flushright}
\textit{Week 3, lecture 2 starts here}
\end{flushright}

\begin{coro}
Every ideal in $S=K[x_1,\ldots,x_n]$ has a finite Gröbner basis with respect to a term order.
\end{coro}
\begin{proof}
The initial ideal in $\In_\prec(I)=\la \In_\prec(f):f\in I\ra$ is a monomial ideal (using that coefficients can be omitted since we are in a field). By Dickson's lemma, there are $g_1,\ldots,g_s\in I$ with $\la \In_\prec(g_1),\ldots,\In_\prec(g_s)\ra=\In_\prec(I)$. Thus $\{g_1,\ldots,g_s\}$ is a Gröbner basis for $I$ by definition.
\end{proof}

\begin{prop}
If $\{g_1,\ldots,g_2\}$ is a Gröbner basis for $I$ with respect to $\prec$, then $I=\la g_1,\ldots,g_2\ra$.
\end{prop}
\begin{proof}
By division algorithm, any $f\in I$ can be written as $f=\sum h_i g_i$ with remainder 0 since $f\in I$. It follows that $f\in\la g_1,\ldots,g_s\ra$, which gives the desired since $f$ is arbitrary.
\end{proof}

\begin{coro}[Special case of Hilbert basis theorem]
Every ideal in $S=K[x_1,\ldots,x_n]$ is finitely generated.
\end{coro}
\begin{proof}
Immediate from previous two results.
\end{proof}
\begin{exe}
Claim: $y=\left\{\underline{x_2^2}-x_1x_3,\underline{x_2x_3}-x_1x_4,\underline{x_3^2}-x_2x_4\right\}$ is a Gröbner basis with respect to revlex. Find the remainder on dividing $x_2^2x_3^2$ by $y$.

\[
\begin{aligned}
f_1:& x_2^2x_3^2 \xrightarrow{f_1} x_1x_3\xrightarrow{f_3}x_1x_2x_3x_4\xrightarrow{f_2}x_1^2x_4^2 \\
f_2:& x_2^2x_3^2 \xrightarrow{f_2} x_1x_2x_3x_4\xrightarrow{f_2} x_1^2x_4^2 \\
f_3:& x_2^2x_3^2 \xrightarrow{f_3}x_2^3x_4\xrightarrow{f_1}x_1x_2x_3x_4\xrightarrow{f_2}x_1^2x_4^2
\end{aligned}
\]

The remainders are the same: this shouldn't surprise us. But we haven't proved it, so why did this work?
\end{exe}

\section{General commutative ring}
\begin{defn}
An ideal $I\subseteq R$ is \textit{prime} if it's proper and $f,g\in I\Rightarrow f$ or $g\in I$.
\end{defn}
\begin{notation}
$\Spec(R):=\{\text{prime ideals in }R\}$.
\end{notation}
\begin{example}
$R=\Z/6\Z,\ \Spec(R)=\{\la 2\ra,\la 3\ra\}$.  Note that although 5 is prime but $\la 5\ra$ is not a prime ideal since $5^2=1$ in $\Z/6\Z$ so it's not proper.
\end{example}
\begin{lemma}
An ideal $P\subseteq R$ is prime iff $R/P$ is a domain.
\end{lemma}
\begin{proof}
$P$ is prime iff
\[
fg\in P\Rightarrow f \text{ or } g\in P. \tag{$\ast$}
\]
$R/P$ is a domain iff $fg+P=0+P \Rightarrow f+P$ or $g+P=0+P$, which is equivalent to $(\ast)$.
\end{proof}

\begin{defn}
An ideal $I\subseteq R$ is \textit{maximal} if it's proper and there is no ideal $J:I\subsetneqq J\subsetneqq R$.
\end{defn}

Do maximal ideals always exist? Yes, if we assume axiom of choice.

Recall: a \textit{partially ordered} set is a set $S$ with transitive, reflexive binary relation $\leq$ (e.g. $\leq$ on $\mathbb R$ or power set (inclusion)). Given a subset $U\subseteq S$, an \textit{upper bound} for $U$ is $s\in S$ with $u\leq s \ \forall u\in U$. An element $m\in S$ is \textit{maximal} if $\nexists s\in S$ with $s>m$.

\begin{axiom}[Zorn's lemma]
Let $S$ be a nonempty partially ordered set with the property that any totally ordered subset $U\subseteq S$ (a `chain') has an upper bound. Then $S$ has a maximal element.
\end{axiom}

This is equivalent to:
\begin{enumerate}
\item The axiom of choice: every product $\prod_{a\in A} S_a$ of nonempty sets is nonempty.
\item Well-ordering principle: every set can be well-ordered.
\end{enumerate}

\begin{flushright}
\textit{Week 3, lecture 3 starts here}
\end{flushright}

\begin{prop}
Let $R$ be a ring and let $I$ be a proper ideal of $R$. Then there is a maximal ideal $M$ containing $I$.
\end{prop}
\begin{proof}
Let $\mathcal I$ be the set of proper ideals in $R$ containing $I$, ordered by inclusion ($J_1\leq J_2$ if $J_1\subseteq J_2$). Note that if $\{J_\alpha:\alpha\in A\}$ is a totally ordered (any two are comparable) subset of $\mathcal I$ then $J=\bigcup_{\alpha\in A}J_\alpha$ is an ideal. [$\lightning$ this uses the total order, e.g. in $K[x,y],\ \la x\ra \cup\la y\ra$ is not an ideal since $x+y$ is not in there.] Since $J_\alpha\subseteq J \ \forall \alpha$ and $I\subseteq J$, one has $J\in \mathcal I$. Hence $J$ is an upper bound for $\{J_\alpha\}$. Thus by Zorn's lemma, $\mathcal I$ has a maximal element.
\end{proof}

\begin{lemma}
$I\subseteq R$ is maximal iff $R/I$ is a field.
\end{lemma}
\begin{proof}
Exercise (see Algebra II notes).
\end{proof}

\begin{coro}
Maximal ideals are prime.
\end{coro}
\begin{proof}
If $I$ is maximal then $R/I$ is a field, and in particular a domain.
\end{proof}

\subsection{Localisation}

\begin{defn}
A ring $R$ is \textit{local} if it has a unique maximal ideal $M$.
\end{defn}
\begin{example}
\label{example:nonexampleLocal}
Every field is local. $\Z$ is not local since $\la2\ra,\la 3\ra$ are both maximal.

Consider
\[
\Z_{\la 2\ra}:=\left\{ \frac{a}{b}\in\Q:a,b\in\Z,\ 2\nmid b \right\}.
\]
This is a subring of $\Q$. Note that proper ideals are those generated by even integers, but $\la 6\ra=\la 2\ra$ since $\frac13 \in \Z_{\la 2\ra}$. So in fact they are all generated by powers of 2, and $\la 2\ra$ is maximal, so $\Z_{\la 2\ra}$ is local.

$\C[x]$ is not local, since we can build (at least two) quotient rings which is a field by first isomorphism theorem, e.g. $\varphi_1 :x\rightarrow 1$ and $\varphi_2 :x\rightarrow i$.

Now consider
\[
\C[x]_{\la x\ra}:= \left\{ \frac{f}{g}:f,g\in\C[x],\ x\nmid g \right\}.
\]
This is analogous to $\Z_{\la x\ra}$ and its proper ideals are of the form $\la x^j\ra$ with $\la x\ra$ being maximal.
\end{example}
\begin{defn}
A set $U\subseteq R$ is \textit{multiplicatively closed} if $1\in U$ and $f,g\in U\Rightarrow fg\in U$.
\end{defn}
\begin{example}
In any $R$ with $f\in R,\ U=\left\{1,f,f^2,\ldots\right\}$ is multiplicatively closed. 

Suppose $P\subseteq R$ is prime. Then $1\notin P$, i.e. $1\in R\backslash P$, and $fg\in P\Rightarrow f$ or $g \in P$, so $f,g\in R\backslash P\Rightarrow fg\in R\backslash P$. By definition this means $R/P$ is multiplicatively closed.

$U=\{r\in R:\exists s\in R:rs=1\}=\{\text{units of }R\}$ is multiplicatively closed. In particular, if $R$ is a domain then $U=R\backslash\{0\}$ is.
\end{example}

\begin{defn}
\label{defn:localisation}
Let $R$ be a ring and let $U\subseteq R$ be multiplicatively closed. Then
\[
R\left[U^{-1}\right]:=\left\{ \frac{r}{u}:r\in R,u\in U \right\}
\]
modulo the equivalence relation $\sim$
\[
\frac{r}{u}\sim\frac{r'}{u'} \quad\text{if}\quad \exists \widetilde u \in U : \widetilde u(ru'-r'u)=0.
\]
\end{defn}
\begin{example}
$R=\Z,\ U=\Z\backslash\{0\}$. Then $R\left[U^{-1}\right]=\Q$. We don't have to worry about the $\widetilde u$ condition since $\Z$ is a domain.

$R=\Z,\ U=\Z\backslash \la 2\ra$. Then $R[U^{-1}]=\Z_{\la 2\ra}$.

$R=\C[x],\ U=\C[x]\backslash \la x\ra$. Then $R[U^{-1}]=\C[x]_{\la x\ra}$.
\end{example}

\begin{flushright}
\textit{Week 4, lecture 1 starts here}
\end{flushright}

\begin{lemma}
\begin{enumerate}
\item The $\sim$ in Definition \ref{defn:localisation} is indeed an equivalence relation.
\item $R[U^{-1}]$ is a ring with addition and multiplication defined
\[
\frac{r}{u}+\frac{r'}{u'}:=\frac{ru'+r'u}{uu'},\quad \left(\frac{r}{u}\right)\left(\frac{r'}{u'}\right):=\frac{rr'}{uu'}
\]
\item The map $\varphi:R\rightarrow R[U^{-1}]$ given by $r\mapsto \frac{r}{1}$ is a ring homomorphism.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}
\item It's reflexive since $1(ru-ru)=0$. It's symmetric since $\widetilde u(ru'-r'u)=0\Rightarrow -1\widetilde u(r'u-ru')=0$ and $-1\widetilde u\in U$ by multiplicative closedness.

Now suppose
\[
\frac{r}{u}\sim\frac{r'}{u'},\quad \frac{r'}{u'}\sim\frac{r''}{u''},
\]
then $\exists \widetilde u\in U:\widetilde u(ru'-r'u)=0$ and $\exists \widetilde u'\in U:\widetilde u'(r'u''-r''u')=0$. So
\[
\widetilde u' u'' (\widetilde u(ru'-r'u))+\widetilde u u (\widetilde u'(r'u''-r''u'))=0.
\]
which is equal to
\[
\widetilde u \widetilde u' (ru'u''-r'uu''+r'uu''-r''uu')=\widetilde u \widetilde u' u' (ru''-r''u)
\]
where $\widetilde u \widetilde u' u'\in U$. Therefore it's transitive.
\item (Exercise) One needs to check:
\begin{itemize}
\item The two operations are well-defined, i.e. they don't depend on choice of representatives
\item Ring axioms, in particular $\frac01$ is additive identity and $\frac11$ is multiplicative identity
\end{itemize}
\item One has $\varphi (r+r')=\frac{r+r'}{1}=\frac{r}{1}+\frac{r'}{1}=\varphi(r)+\varphi(r')$ and $\varphi(rr')=\frac{rr'}{1}=\left(\frac{r}{1}\right)\left(\frac{r'}{1}\right)=\varphi(r)\varphi(r')$.
\end{enumerate}
\end{proof}

\begin{remark}
\begin{enumerate}
\item If $U$ contains 0 then it's very boring: $R[U^{-1}]=0$ iff $0\in U$. Indeed, for $R[U^{-1}]=0$ one needs $\exists u\in U:u\cdot 1=0$, and the only such $u$ is 0, and if $0\in U$ then $0(r\cdot1-0\cdot 1)=0r=0 \ \forall r$ hence $\frac{r}{1}\sim\frac01 \ \forall r$.
\item $\varphi$ is not always injective, e.g. $R=\Z/6\Z,\ U=\{1,3,5\}$. Then $\varphi(2)=\frac21$ but $\frac21 \sim \frac01$ since $3(2\times 1-0\times 1)=0$. Furthermore, $\ker\varphi=\left\{r\in R:\frac{r}{1}\sim \frac01\right\}=\{r\in R:\exists u\in U:ur=0\}$.
\end{enumerate}
\end{remark}

\begin{notation}[Important special case]
In the case of $U=R\backslash P$ where $P$ is prime, we write $R_P$ for $R[(R\backslash P)^{-1}]$. An example would be, again, $\Z_{\la2\ra}$.
\end{notation}
Why is this important?
\begin{prop}
The set $P_P:=\left\{\frac{r}{u}\in R_P:r\in P\right\}$ is an ideal of $R_P$ and is the unique maximal ideal.
\end{prop}
\begin{proof}
If $\frac{r}{u}\notin P_P$ then $r\notin P$, so $\frac{u}{r}\in R_P$ and hence $\frac{r}{u}$ is a unit. Now suppose there is a maximal ideal $I$ and in particular $\exists \frac{r}{u}\in I\backslash P_P$. But then $I$ would be the whole ring $R_P$ since it contains a unit. This argument also justifies that $P_P$ is maximal itself.
\end{proof}

\begin{coro}[A fortunate byproduct of the proof]
$I\subseteq R$ is the unique maximal ideal iff every $r\notin I$ is a unit.
\end{coro}

\begin{flushright}
\textit{Week 4, lecture 2 starts here}
\end{flushright}

\subsubsection{Effect of localisation on ideals}
We want to investigate the relationship between $\Spec(R)$ and $\Spec(R[U^{-1}])$.

We have the ring homomorphism $\varphi$, but $I\mapsto \varphi(I):=\{\varphi(r):r\in I\}$ is not good enough, since if $R=\Z,\ U=\Z\backslash\{0\}$ then $R[U^{-1}]=\Q$ is a field, so it has only two ideals, and $\varphi(I)=\left\{ \frac{n}{1}:n\text{ even} \right\}$ obviously is not one of them. Rather we need $I\mapsto \varphi(I)R[U^{-1}]:=\la \varphi(r):r\in I\ra$. In the above case, $\varphi(I)R[U^{-1}]=\Q$.

For the other way, we can simply consider $J\mapsto \varphi^{-1}(J)$ as a map without the `generated by'.

\begin{lemma}
There is a bijection between ideals $J\subseteq R[U^{-1}]$ and ideals $I\subseteq R$ with property
\[
\tag{$\star$}
ru\in I \text{ for some } u\in U\Rightarrow r\in I.
\]
\end{lemma}
\begin{example}
In the above example, $\la 6\ra$ is not such ideal $I\subseteq \Z$ since $6=6\times 1\in \la 6\ra,\ 6\in U$ but $1\notin\la 6\ra$. Note that this argument works for any $\la n\ra$ where $n>1$. In fact, the only two ideals that satisfy this are $\la 0\ra,\la 1\ra$ which indeed have a natural bijection to ideals in $\Q$.
\end{example}

\begin{proof}
To show $J\mapsto \varphi^{-1}(J)$ is injective, we show $\varphi(\varphi^{-1}(J))R[U^{-1}]=J$.

$\subseteq$ is clear: $\varphi^{-1}(J)=\left\{r:\frac{r}{1}\in J\right\}$, so $\varphi(\varphi^{-1}(J))=\left\{\frac{r}{1}:\frac{r}{1}\in J\right\}$, and if you take the ideal generated by a subset of $J$ of course you get something contained in $J$.

To see $\supseteq$, note that
\[
\frac{r}{u}\in J\Rightarrow \frac{u}{1}\frac{r}{u}=\frac{r}{1}\in J,
\]
so $r\in\varphi^{-1}(J)$ and $\frac{r}{1}\in \varphi(\varphi^{-1}(J))R[U^{-1}]$ and furthermore for any
\[
u\in U,\quad \frac{1}{u}\frac{r}{1}=\frac{r}{u}\in \varphi(\varphi^{-1}(J))R[U^{-1}].
\]

To show $J\mapsto \varphi^{-1}(J)$ is surjective, fix $I\subseteq R$ satisfying $\star$ and let $J=\varphi(I)R[U^{-1}]$. The proof is then complete if we show $I=\varphi^{-1}(J)$.

$\frac{r}{1}\in\varphi(I)R[U^{-1}]$ means
\[
\begin{aligned}
\frac{r}{1}&=\sum \frac{h_i}{u_i} \frac{r_i}{1} \text{ where } r_i\in I,\ h_i\in R,\ u_i\in U \\
&=\frac{\widetilde r}{u} \text{ for some } \widetilde r\in I,\ u\in U.
\end{aligned}
\]
By definition, this implies $\exists \widetilde u\in U:\widetilde u(ur-\widetilde r)=0$, i.e. $(\widetilde uu)r=\widetilde u\widetilde r \in I$ since $\widetilde r\in I$. By assumption, $r\in I$. This shows $\varphi^{-1}(J)\subseteq I$, and since $\frac{r}{1}\in J \ \forall r\in I,\ I\subseteq \varphi^{-1}(J)$.
\end{proof}

\begin{exe}[$\ast$]
What ideals $I\subseteq \Z$ satisfy $\star$ when $U=\{\text{odd numbers}\}$ and when $U=\{1,2,4,8,\ldots\}$?

For $U=\{\text{odd numbers}\}$, recall Example \ref{example:nonexampleLocal}. $U=\Z\backslash \la2\ra$, so ideals $I\subseteq \Z$ satisfy $\star$ corresponds to ideals of $\Z_{\la 2\ra}$, which are generated by powers of 2 (and also the 0 ideal).
\end{exe}

\begin{coro}
$J\mapsto \varphi^{-1}(J)$ maps $\Spec(R[U^{-1}])$ to $\{P\in\Spec(R):P\cap U=\varnothing\}$.
\end{coro}

\begin{proof}
In Homework 2 it will be proved that for any ring homomorphism $\varphi:R\rightarrow S,$ if $P\subseteq S$ is prime then $\varphi^{-1}(P)\subseteq R$ is prime. Now if a prime $P\subseteq R$ satisfies $P\cap U=\varnothing$ and if $ru\in P$ for some $u\in U$, then $r\in P$ since $P$ is prime and $u\notin P$, so it's indeed the image. Conversely, if $\star$ holds then $P\cap U=\varnothing$ since if $u\in P\cap U,\ u=u\cdot 1\in P$ but $1\notin P$, a contradiction.
\end{proof}

\begin{flushright}
\textit{Week 4, lecture 3 starts here}
\end{flushright}

\section{Module}
\begin{defn}
Let $R$ be a ring. An $R$\textit{-module} is an abelian group $M$ with multiplication $R\times M\rightarrow M$ (sometimes called $R$-action) satisfying
\begin{enumerate}
\item $r(m+n)=rm+rn$ 
\item $(r+r')m=rm+r'm$
\item $(rr')m=r(r'm)$
\item $1_R m=m$
\end{enumerate}
$\forall r,r'\in R,\ m,n\in M$.
\end{defn}

\begin{example}
If $R=K$ is a field then $M$ is a $K$-vector space. In fact, the definition should remind you of that of vector spaces.

If $R=\Z$ then $R$-modules are abelian groups with $R\times M\rightarrow M$ given by $n\times g:=\underbrace{g+\cdots+g}_{n\text{ times}}$. One is forced to define multiplication like this by definition.

If $R$ is an arbitrary ring and $I$ is an ideal in $R$, then $R$ itself is a $R$-module with multiplication the same as ring multiplication in $R$, and $I,\ R/I$ are also $R$-modules.
\end{example}

\begin{remark}
Much of commutative algebra is generalising linear algebra to modules, and every theorem you see about modules, ask what it says for vector spaces/abelian groups. 
\end{remark}

\begin{defn}
A subset $N\subseteq M$ is a \textit{submodule} if
\begin{enumerate}
\item $m,n\in N\Rightarrow m+n\in N$ and
\item $m\in N,\ r\in R\Rightarrow rm\in N$.
\end{enumerate}
\end{defn}
\begin{example}
A submodule of the $R$-module $R$ is precisely an ideal.
\end{example}
Like any other algebraic objects, it's important to understand functions between modules. We want a definition that can be generalised to group homomorphisms since modules are abelian groups, and can be specified to linear maps since vector spaces are modules.
\begin{defn}
A function $\varphi:M\rightarrow N$ where $M,N$ are $R$-modules is an $R$\textit{-module homomorphism} if
\begin{enumerate}
\item $\varphi$ is a group homomorphism and
\item $\varphi(rm)=r\varphi(m)$.
\end{enumerate}
\end{defn}
\begin{example}
As expected, if $R$ is a field then an $R$-module homomorphism is a linear map, and if $R=\Z$ then it's a group homomorphism. Also $R\rightarrow R/I$ and $I\rightarrow R$ for $I$ an ideal given by $r\mapsto r$ are $R$-module homomorphisms.
\end{example}
\begin{defn}
The \textit{kernel} of an $R$-module homomorphism $\varphi:M\rightarrow N$ is
\[
\ker\varphi :=\{m\in M:\varphi(m)=0_N\},
\]
and the \textit{image} of $\varphi$ is
\[
\im \varphi=\{\varphi(m):m\in M\}.
\]
\end{defn}
\begin{exe}
Show that these are both submodules of $M$ and $N$ respectively.
\end{exe}

\begin{defn}
If $N$ is a submodule of an $R$-module $M$, then it is also a subgroup of the abelian group $M$, so we can construct quotient group $M/N$. This is an $R$-module with $r(m+N)=rm+N$ and called a \textit{quotient module}.
\end{defn}

\begin{thm}[Isomorphism theorems]
\begin{enumerate}
\item If $\varphi:M\rightarrow N$ is an $R$-module homomorphism then $M/\ker\varphi \cong \im \varphi$. (The morally equivalence of this in linear algebra is the rank–nullity theorem.)
\item If $L\subseteq M\subseteq N$ with $L$ a submodule of $M$ and $M$ a submodule of $N$, then $N/M\cong (N/L)/(M/L)$.
\item If $L,M$ are submodules of $N$ then $(L+M)/L\cong M/(M\cap L)$ where $L+M:=\{l+m:l\in L, m\in M\}$. (This is a generalisation of the proposition about dimensions of subspaces in linear algebra.)
\end{enumerate}
\end{thm}

\begin{flushright}
\textit{Week 5, lecture 1 starts here}
\end{flushright}

\subsection{Free module}
Recall that every finite dimensional $K$-vector space is isomorphic to $K^n$.
\begin{defn}
The $R$-module $R^n$ is defined to be
\[
\{(r_1,\ldots,r_n):r_i\in R\}
\]
with $R$-action
\[
r(r_1,\ldots,r_n)=(rr_1,\ldots,rr_n),\qquad (r_1,\ldots,r_n)+(r_1',\ldots,r_n')=(r_1+r_1',\ldots,r_n+r_n').
\]
\end{defn}

\begin{remark}
\begin{enumerate}
\item More generally, for any index set $A$ (might be uncountable), $M_1:=\{(r_\alpha:\alpha\in A):r_\alpha\in R\}$ (functions $A\rightarrow R$) and $M_2:=\{(r_\alpha:\alpha\in A):r_\alpha\in R,\text{ only finitely many }r_\alpha\neq 0\}$ are $R$-modules.
\item Note that every element of $R^n$ can be written as an $R$-linear combination of the standard basis $e_i$ as expected.
\end{enumerate}
\end{remark}

\begin{defn}
Let $M$ be an $R$-module and $\mathcal G=\{m_\beta:\beta\in B\}\subseteq M$. Then $\mathcal G$ \textit{generates} $M$ (as an $R$-module) if every element $m\in M$ can be written as
\[
m=\sum_{i=1}^s r_i m_{\beta_i} \text{ for some } \beta_1,\ldots,\beta_s\in B,\quad r_1,\ldots,r_s\in R.
\] 
Note that $B$ might be infinite but the sum must be finite.
\end{defn}

\begin{example}
\begin{enumerate}
\item If $R$ is a field then the verb generate is the same as `span' as in linear algebra.
\item If $R=\Z$ then $\mathcal G$ generates $M$ iff it generates $M$ as an abelian group.
\item If $M=I\subseteq R$ is an ideal, then $\mathcal G$ generates $M$ as an $R$-module iff $g$ generates $I$ as an ideal.
\end{enumerate}
\end{example}

\begin{exe}
\begin{enumerate}
\item Give an example of an $R$-module $M$ with $g\subseteq M$ that generates $M$ as an $R$-module but not as an abelian group.

Consider $M=R=\mathbb R$. Then $\mathcal G=\{1\}$ generates $M$ as an $R$-module, but the abelian group it generates is $\Z\subsetneqq \mathbb R$.
\item Generators for $M_1,M_2$ in above remark?
\end{enumerate}
\end{exe}

\begin{defn}
A set $\mathcal G\subseteq M$ is a \textit{basis} for $M$ if $\mathcal G$ generates $M$ as an $R$-module and every element of $M$ can be written uniquely as an $R$-linear combination of finitely many elements of $\mathcal G$. Equivalently, if $\sum_{i=1}^s r_i g_i=0_M$ for $g_i\in \mathcal G,\ r_i\in R$ then $r_i=0 \ \forall i=0$.
\end{defn}

\begin{example}
\begin{enumerate}
\item If $R$ is a field then a basis for $M$ as an $R$-module is a basis for $M$ as a $R$-vector space.
\item A basis for $R^2$ is $\{(1,0),(0,1)\}$.
\item $\{e_\alpha\}$ is a basis for $M_2$. It's not a basis for $M_1$ since the sum could be infinite. $\lightning$ There are modules with no basis (that's kind of the point of this section), e.g. $R=\C[x,y],\ M=\la x,y\ra$. Suppose $M$ has a basis $\mathcal G$. First of all $|\mathcal G|>1$ since $M$ is not a principal ideal. Now pick $f,g\in \mathcal G$. Then $fg\in M$, but $fg=fg=gf$, so not uniquely expressed, a contradiction.
\end{enumerate}
\end{example}

\begin{flushright}
\textit{Week 5, lecture 2 starts here}
\end{flushright}

\begin{defn}
A $R$-module is \textit{free} if it has a basis.
\end{defn}
\begin{example}
$R^n$ and $M_2$ are free. $\la x,y\ra \subseteq \C[x,y]$ is not a free $\C[x,y]$-module, but it's a free $\C$-module since $\C$ is a field so it's a vector space, which always has a basis.

$\Q$ is not a free $\Z$-module. First a basis would have to be infinite, but $bc\left(\frac{a}{b}\right)-ad\left(\frac{c}{d}\right)=0$, a nontrivial linear dependence relation.
\end{example}

\subsection{Cayley–Hamilton theorem}
\begin{remark}
Matrices make sense over an arbitrary ring and give a $R$-module homomorphism $\varphi:R^n\rightarrow R^m$. Determinants still make sense (as a indicator of whether $\varphi$ is invertible).
\end{remark}

\begin{defn}
Let $M$ be an $R$-module. The set of all $R$-module homomorphisms $\varphi:M\rightarrow M$ forms a noncommutative ring with identity and $(\varphi+\varphi)(m)=\varphi(m)+\varphi(m)$ and $(\varphi\psi)(m)=\varphi(\psi(m))$, denoted $\End(M)$.
\end{defn}
\begin{example}
If $R$ is a field and $M=R^n$ then $\End(M)=n\times n$ matrices.
\end{example}

\begin{flushright}
\textit{Week 5, lecture 3 starts here}
\end{flushright}

\begin{notation}
$\{\varphi_s:s\in R\}$ where $\varphi_s(m):=sm$.
\end{notation}

\begin{defn}
\label{defn:RadjoinA}
Given an $n\times n$ matrix $A$, the subring $R[A]$ of $\End(R^n)$ is the smallest subring of $\End(R^n)$ containing $A$  and all $\{\varphi_s:s\in R\}$. Explicitly,
\[
R[A]=\left\{\sum_{i=0} a_i A^i:a_i\in R\right\}
\] 
and set $A^0=I$.
\end{defn}
\begin{remark}
Note that $R[A]$ is commutative, and (suggestive by notation) we have a ring homomorphism
\[
\begin{aligned}
\psi:R[x]&\rightarrow R[A] \\
x&\mapsto A.
\end{aligned}
\]
This is of course not an isomorphism by Cayley–Hamilton theorem.

Also, $R^n$ is an $R[A]$ module with action given by
\[
\left(\sum_{i=0} a_i A^i\right) \underline v = \sum_{i=0} a_i \left(A^i \underline v\right)
\]
where $\underline v = (r_1,\ldots,r_n)\in R^n$.
\end{remark}

\begin{defn}
The \textit{characteristic polynomial} of $A\in\End(R^n)$ is $\det (xI-A)\in R[x]$.
\end{defn}

\begin{example}
\begin{enumerate}
\item $A=\begin{pmatrix}x & x^2 \\ x^3 & x^4\end{pmatrix}$ and $R=\C[x]$. Then
\[
\begin{aligned}
\det \begin{pmatrix}t-x & x^2 \\ x^3 & t-x^4\end{pmatrix}&=(t-x)(t-x^4)-x^5\\
&=t^2-(x+x^4)t+x^5-x^5\\
&=t^2-(x+x^4)t.
\end{aligned}
\]

\item $A=\begin{pmatrix}1&2\\3&4\end{pmatrix}$ and $R=\Z/6\Z$. Then
\[
\det \begin{pmatrix}x-1&2\\3&x-4\end{pmatrix}=(x-1)(x-4)-6=x^2-5x-2=x^2+x+4.
\]
\end{enumerate}
\end{example}

\begin{remark}
Recall the adjoint of an $n\times n$ matrix $B$ is the matrix $C$ with 
\[
C_{ij}=(-1)^{i+j} \det \left(B\backslash i\text{th column and }j\text{th row} \right),
\]
which makes sense over any ring. We claim $BC=CB=\det B I_n$ (which implies if $\det B$ is a unit then $B$ is invertible). Indeed,
\[
\begin{aligned}
(BC)_{ij} &= \sum_{k=1}^n B_{ik} C_{kj}\\
&=\sum_{k=1}^n (-1)^{k+j} B_{ik} \det \left(B\backslash k\text{th column and }j\text{th row} \right)\\
&=\det \left(B\text{ with }j\text{th row replaced by }i\text{th row}\right)\\
&=\left\{ \begin{aligned}
  0 &\text{ if } i\neq j\\ \det B &\text{ if } i= j
\end{aligned} \right. \\
&=\left(\det B I_n\right)_{ij}.
\end{aligned}
\]
\end{remark}

\begin{thm}[Cayley–Hamilton]
Let $R$ be a ring and let $A$ be an $n\times n$ matrix with entries in $R$. Set $p_A(x)=\det (xI-A)\in R[x]$, then $p_A(A)=0$, i.e. $p_A\in\ker\psi$ where $\psi$ is as in remark after Definition \ref{defn:RadjoinA}.
\end{thm}

\begin{defn}
An $R$-module $M$ is \textit{finitely generated} if it has a finite generating set.
\end{defn}

\begin{thm}
\label{thm:generalCH}
Let $M$ be a finitely generated $R$-module with $n$ generators and $\varphi:M\rightarrow M$ an $R$-module homomorphism. Suppose $I$ is an ideal of $R$ with $\varphi(M)\subseteq IM:=\la rm:r\in I,m\in M\ra$. Then $\varphi$ satisfies a relation of the form
\[
\varphi^n + a_1 \varphi^{n-1} + a_{n-1}\varphi + a_n=0 \in\End(M) \text{ where } a_i\in I.
\]
\end{thm}

\begin{flushright}
\textit{Week 6, lecture 1 starts here}
\end{flushright}

\begin{proof}[Proof of Cayley–Hamilton theorem]
Write $e_1,\ldots,e_n$ for the standard basis for $R^n$ and one has $Ae_k=\sum_{j=1}^n a_{jk} e_j$ (the $k$th column of $A$). Write $\delta_{jk}$ for the Kronecker delta. Then
\[
\begin{aligned}
\sum_{j=1}^n \left(A\delta_{jk}-a_{jk}I\right) e_j=\sum_{j=1}^n A\delta_{jk}e_j - \sum_{j=1}^n a_{jk}Ie_j = Ae_k-Ae_k=0.
\end{aligned}
\]
Let $B=(B_{jk})$ be the $n\times n$ matrix with entries in $R[A]$ with $B_{jk}=A\delta_{jk}-a_{jk}I$ and $C$ the adjoint of $B$. Then
\[
\begin{aligned}
0&=\sum_{k=1}^n C_{kj} \left(\sum_{i=1}^n A\delta_{ik}-a_{ik} I\right)e_i = \sum_{i=1}^n \left( \sum_{k=1}^n C_{kj} (A\delta_{ik}-a_{ik}I)e_i \right) \\
&=\sum_{i=1}^n \sum_{k=1}^n B_{ik}C_{kj} e_i=\sum_{i=1}^n (BC)_{ij} e_i=(\det B )e_j=\begin{pmatrix}
0 \\ \vdots \\ \det B \\ \vdots \\ 0
\end{pmatrix} \leftarrow \text{the }j\text{th position} ,
\end{aligned}
\]
so $\det B=0$.

Now $p_A(x)\in R[x]$. Then
\[
\psi(p_A(x))=p_A(A)=\det \left( \begin{pmatrix}
  A & & & 0 \\ & A & & \\ & & \ddots & \\ 0 & & & A
\end{pmatrix}-A \right)=\det B=0.
\]
\end{proof}

\begin{exe}
Let
\[
D=\begin{pmatrix}
\begin{pmatrix}1&0\\0&1\end{pmatrix} & \begin{pmatrix}1&2\\3&4\end{pmatrix} \\ \begin{pmatrix}3&0\\0&4\end{pmatrix} & \begin{pmatrix}5&6\\7&8\end{pmatrix}
\end{pmatrix}.
\]
Then
\[
\begin{aligned}
\det D&=\begin{pmatrix}1&0\\0&1\end{pmatrix}\begin{pmatrix}5&6\\7&8\end{pmatrix}-\begin{pmatrix}1&2\\3&4\end{pmatrix}\begin{pmatrix}3&0\\0&4\end{pmatrix}\\
&=\begin{pmatrix}5&6\\7&8\end{pmatrix}-\begin{pmatrix}3&8\\9&16\end{pmatrix}\\
&=\begin{pmatrix}2&-2\\-2&-28\end{pmatrix}.
\end{aligned}
\]
\end{exe}

\begin{proof}[Proof of Theorem \ref{thm:generalCH}]
Let $\{m_1,\ldots,m_n\}$ be a generating set for $M$. Since $\varphi(M)\in IM$, one can write
\[
\varphi(m_i)=\sum_{i=1}^n a_{ji} m_j\text{ with }a_{ji}\in I.
\]
So $\sum_{j=1}^n(\delta_{ji}\varphi-a_{ji})m_j=0$ where $\delta_{ji}\varphi-a_{ji}$ can be analogously be viewed as an element of $R[\varphi]$, which is a commutative ring. Write $B$ for the $n\times n$ matrices with entries in $R[\varphi]$ and $B_{ij}=\delta_{ji}\varphi-a_{ij}$. Let $C$ be the adjoint of $B$. Then
\[
0=\sum_{i=1}^n C_{ki} \left(\sum_{j=1}^n B_{ij}m_j\right)=\sum_{j=1}^n \left(\sum_{i=1}^n C_{ki}B_{ij}\right)m_j=\sum_{j=1}^n (CB)_{kj} m_j=(\det B)m_k,
\]
so $(\det B)m=0 \ \forall m\in M$, hence $\det B=0\in \End(M)$. Expanding $\det B$ as a polynomial in $\varphi$ gives us the desired.
\end{proof}

\begin{flushright}
\textit{Week 6, lecture 2 starts here}
\end{flushright}

\subsubsection{Corollaries of C–H theorem: Nakayama's lemma(s)}
\begin{coro}
If $M$ is a finitely generated $R$-module and $I$ an ideal of $R$ with $IM=M$, then $\exists r\in R:r-1\in I,\ rM=0$.
\end{coro}
\begin{proof}
Let $\varphi=\id$. Then $\varphi(M)\subset M\subset IM$. So by Theorem \ref{thm:generalCH}, one has
\[
\varphi^n + \sum_{i=1}^{n-1}a_i\varphi^{n-1}+a_n=\left(1+\sum_{i=1}^n a_i\right)\varphi=0\text{ where }a_i\in I^i.
\]
Set $r:=1+\sum_{i=1}^n a_i$. Then $r-1\in I$ and $rm=0 \ \forall m\in M$. 
\end{proof}

\begin{coro}
Let $R$ be a local ring with maximal ideal $\m$ and $M$ a finitely generated $R$-module. If $\m M=M$, then $M=0$.
\end{coro}
\begin{proof}
By corollary above, $\exists r\in R:r-1\in\m$ and $rm=0 \ \forall m\in M$. But then $r\notin \m$ since otherwise $r-(r-1)=1\in\m$ hence not maximal. So $r$ is a unit. But then
\[
m=1m=\left(r^{-1}r\right)m =r^{-1} (rm)=r^{-1}0=0 \quad \forall m\in M
\]
and thus $M=0$.
\end{proof}

\begin{coro}
Let $R$ be a local ring with maximal ideal $\m$. If $M$ is a finitely generated $R$-module and $m_1,\ldots,m_n\in M$ are elements whose images span the (\textit{residue field}) $k=R/\m$-vector space $\overline M=M/\m M$, then $m_i$ generate $M$.
\end{coro}
\begin{remark}[Sanity check before the proof]
Verify that this is well-defined, i.e. $r+\m=r'+\m,\ m+\m M=m'+\m M \Rightarrow rm+\m M=r'm'+\m M$. Indeed, if $r-r'\in\m$ and $m-m'\in\m M$, then $rm-r'm'=(r-r')m+(m-m')r'\in \m M$.
\end{remark}
\begin{proof}
Let $N$ be the submodule of $M$ generated by $m_i$. Since $m_i+\m M$ span $M/\m M$, each element of $M$ can be written as
\[
m=\sum_{i=1}^n r_i m_u + rm'\text{ where } r_i\in R,\ r\in \m,\ m'\in M.
\]
Thus $m=n+rm'$ for $n\in N$, i.e. $M/N=\m M/N$. So by corollary above $M/N=0$, so $M=N$ and one has the desired.
\end{proof}

\begin{remark}[$\lightning$]
These all needed $M$ to be finitely generated. If (recall Example \ref{example:nonexampleLocal}) $R=\Z_{\la 2\ra}$ and $M=\Q$, then $\la 2\ra \Q=\Q$, but clearly $\Q\neq 0$. This is not a counterexample since $\Q$ is not finitely generated.

Also, the last two needed $R$ to be local. Consider $\Z$ as a $\Z$-module. $2\Z$ is maximal and the image of 5 (which is 1) generates $\Z/2\Z$, but 5 clearly does not generate $\Z$.
\end{remark}

\begin{flushright}
\textit{Week 6, lecture 3 starts here}
\end{flushright}

\subsection{Localisation of modules}
\begin{defn}
Let $M$ be an $R$-module and $U\subseteq R$ a multiplicatively closed set. Then
\[
M\left[U^{-1}\right]:=\left\{\frac{m}{u}:m\in M,u\in U\right\}
\]
modulo the equivalence relation
\[
\frac{m}{u}\sim \frac{m'}{u'} \text{ if } \exists \widetilde u\in U:\widetilde u (u'm-um')=0.
\]
This is an $R\left[U^{-1}\right]$-module.
\end{defn}
Readers should verify that the $R\left[U^{-1}\right]$-action $\frac{r}{u}\cdot \frac{m}{u'}=\frac{rm}{uu'}$ is well-defined and $M\left[U^{-1}\right]$ obeys the module axioms.

\begin{lemma}
Let $R$ be a ring and $M$ an $R$-module.
\begin{enumerate}
\item If $m\in M,\ m=0 \Leftrightarrow \frac{m}{1}= \frac{0}{1}$ in every localisation $M_{\m}=M[U^{-1}]$ at a maximal ideal $\m$ where $U=R\backslash \m$.
\item $M=0 \Leftrightarrow M_{\m}=0$ for every maximal ideal $\m$ of $R$. 
\end{enumerate}
\end{lemma}

\begin{defn}
The \textit{annihilator} of an element $m\in M$ is $\ann(m):=\{r\in R:rm=0_M\}$.
\end{defn}
\begin{example}
$R=\Z,\ M=\Z/6\Z$. Then $\ann(1)=\la 6\ra,\ \ann(2)=\la 3\ra$. In general, $\ann(m)$ would be an ideal.
\end{example}

\begin{proof}
\begin{enumerate}
\item $\frac{m}{1}= \frac01 \Leftrightarrow \exists u\notin\m:um=0 \Rightarrow \ann(m)\not\subseteq \m$. If $m\neq 0$ then $\ann (m)\neq R$ since $1m=m\neq 0$. So by definition $\exists$ a maximal ideal $\m$ with $\ann (m)\subseteq \m$, so $\frac{m}{1}\neq \frac01$ in $M_{\m}$. The other direction is clear.
\item $M=0\Leftrightarrow m=0\ \forall m\in M \Leftrightarrow \forall m\in M, \frac{m}{1}= \frac01 \in M_{\m} \ \forall \m \Leftrightarrow M_{\m}=0 \ \forall \m$.
\end{enumerate}
\end{proof}

\begin{flushright}
\textit{Week 7, lecture 1 starts here}
\end{flushright}

\begin{defn}[/Lemma]
Let $\varphi:M\rightarrow N$ be an $R$-module homomorphism and $P$ a prime ideal of $R$. Define $\varphi_P:M_P\rightarrow N_P$ (where again $M_P$ denotes $M[U^{-1}]$ where $U=R\backslash P$) by $\displaystyle \frac{m}{u}\mapsto\frac{\varphi(m)}{u}$.
\end{defn}
Check this is well defined: if $\frac{m}{u}=\frac{m'}{u'}$ then $\exists \widetilde u\in U:\widetilde u(u'm-um')=0$, so $0_N=\varphi(0_M)=\varphi(\widetilde u(u'm-um'))=\widetilde u (u'\varphi(m)-u\varphi(m'))$, i.e. $\frac{\varphi(m)}{u}=\frac{\varphi(m')}{u}$. Readers should also check it's a homomorphism.

\begin{coro}
If $\varphi:M\rightarrow N$ is an $R$-module homomorphism, then $\varphi$ is injective (or surjective, or bijective) iff for every maximal $\m$ of $R$, $\varphi_{\m}:M_\m \rightarrow N_\m$ is injective (or surjective, or bijective).
\end{coro}
\begin{proof}
One has
\[
\begin{aligned}
\ker\varphi_\m &= \left\{\frac{m}{u}:\frac{\varphi(m)}{u}=\frac01\right\} = \left\{\frac{m}{u}:\exists \widetilde u\notin \m:\widetilde u(\varphi(m))=0\right\} \\&= \left\{\frac{m}{u}:\exists \widetilde u\notin \m:\varphi(\widetilde um)=0\right\} \subseteq (\ker\varphi)_\m
\end{aligned}
\]
since $\displaystyle \frac{m}{u}=\frac{\widetilde um}{\widetilde uu}$. Now if $\displaystyle \frac{m}{u}\in(\ker\varphi)_\m$ then $\displaystyle \varphi_m\left(\frac{m}{u}\right)=\frac{\varphi(m)}{u}=0$, so $\displaystyle \frac{m}{u}\in\ker\varphi_m$. Hence
\[
\begin{aligned}
\varphi\text{ injective} &\Leftrightarrow \ker\varphi=0 \Leftrightarrow (\ker\varphi)_\m=0 \ \forall \m \Leftrightarrow \ker\varphi_\m=0 \ \forall \m \\&\Leftrightarrow \varphi_\m\text{ injective } \forall \m.
\end{aligned}
\]

Now consider cokernel $N/\im\varphi$, which is $0$ iff $\varphi$ is surjective. We claim $(N/\im\varphi)_\m \cong N_\m/\im\varphi_\m$ by the map $\displaystyle \frac{n+\im\varphi}{u}\mapsto\frac{n}{u}+\im\varphi$. Rest of proof is left as an exercise.
\end{proof}

\section{Integral closure}
\begin{defn}
Let $R$ be a ring. A ring $S$ is an $R$\textit{-algebra} if $\exists$ a homomorphism $\varphi:R\rightarrow S$. This implies $S$ is a $R$-module with $R$-action given by $r\cdot s:=\varphi(r)s$.
\end{defn}
\begin{example}
$\C[x_1,x_2]$ is a $\C$-algebra, $\Q\left(\sqrt 3\right)$ is a $\Q$-algebra, $\Z/6\Z$ is a $\Z$ algebra.
\end{example}

\begin{defn}
$S$ is \textit{finite} over $R$ if $S$ is a finitely generated $R$-module.
\end{defn}

\begin{defn}
$s\in S$ is \textit{integral} over $R$ if there is a monic polynomial $f(y)=y^n+a_1y^{n-1}+\cdots+a_n\in R[y]$ with $f(s)=0$. If every element of $S$ is integral over $R$, we say $S$ is \textit{integral} over $R$.
\end{defn}
\begin{example}[Why `integral'?]
$\Q$ is a $\Z$-algebra, and $q\in\Q$ is integral iff $q\in\Z$.

$\Z\left[\frac{1+\sqrt5}{2}\right]$ is a $\Z$-algebra, and $\varphi=\frac{1+\sqrt5}{2}$ is integral since $\varphi^2-\varphi-1=0$.

$\Z\left[\frac13\right]=\Z_{\la3\ra}$ is a $\Z$-algebra. Let's prove $\frac13$ is not integral. Suppose
\[
f\left(\frac13\right)=\left(\frac13\right)^n+\sum_{i=0}^{n-1} a_{n-i}\left(\frac13\right)^i=0.
\]
Then
\[
1+\sum_{i=0}^{n-1}a_{n-i}3^{n-i}=0,
\]
which is impossible since LHS $=1\Mod 3$ and RHS $=0\Mod 3$.
\end{example}

\begin{notation}
For a $R$-algebra $S$ with $R\subseteq S$ and $s_1,\ldots,s_m$ elements of $S$, write $R[s_1,\ldots,s_m]$ for the smallest subring of $S$ containing $R$ and $s_1,\ldots,s_m$.
\end{notation}

\begin{flushright}
\textit{Week 7, lecture 2 starts here}
\end{flushright}

\begin{lemma}
We can explicitly write
\[
R[s_1,\ldots,s_m]=\left\{ \sum_{u\in\mathbb N^n}^k a_u s^u:a_u\in R \text{ and only finitely many } a_u\neq 0\right\}.
\]
\end{lemma}

\begin{defn}
$S'\subseteq S$ is an $R$\textit{-subalgebra} if $S'$ is a subring and $\varphi:R\rightarrow S$ has image in $S'$.
\end{defn}

\begin{prop}
\label{prop:sintthenRsfinite}
Let $S$ be an $R$-algebra with $R\subseteq S$ and fix $s\in S$. The following are equivalent:
\begin{enumerate}
\item $s$ is integral over $R$.
\item Subring $R[s]\subseteq S$ is finite over $R$.
\item There is an $R$-subalgebra $R'\subseteq S:R[s]\subseteq R'$ and $R'$ is finite over $R$.
\end{enumerate}
\end{prop}

\begin{proof} \

\begin{enumerate}
\item[$1\Rightarrow 2$:] If $s$ satisfies a relation $s^n+a_1s^{n-1}+\cdots+a_n=0$ with $a_i\in R$, then $R[s]$ is generated by $1,s,\ldots,s^{n-1}$ as an $R$-module. Indeed, if $f\in R[s]$ is a polynomial in $s$ of degree $\geq n$, then we can use the relation to lower the degree.
\item[$2\Rightarrow 3$:] Take $R'=R[s]$.
\item[$3\Rightarrow 1$:] Consider the $R$-module homomorphism $\varphi:R'\rightarrow R'$ given by $r\mapsto sr$. Since $R'$ is a finitely generated $R$-module, $\varphi$ satisfies a relation $\varphi^n+a_1\varphi^{n-1}+\cdots+a_n=0$ where $a_i\in R$ by Theorem \ref{thm:generalCH} and taking $I=R$. Applying this to $1_R$ gives $s^n+a_1s^{n-1}+\cdots+a_n=0$, so $s$ is integral.
\end{enumerate}
\end{proof}

\begin{thm}
\label{thm:integral}
Let $S$ be a $R$-algebra with $R\subseteq S$.
\begin{enumerate}
\item If $R\subseteq S\subseteq S'$, $S'$ is finite over $S$ and $S$ is finite over $R$, then $S'$ is finite over $R$.
\item If $s_1,\ldots,s_m\in S$ are integral, then $R[s_1,\ldots,s_m]$ is finite over $R$ and in particular integral over $R$.
\item If $R\subseteq S\subseteq S'$, $S'$ is integral over $S$ and $S$ is integral over $R$, then $S'$ is integral over $R$.
\item The subset
\[
\widetilde R:=\{s\in S:s\text{ integral over }R\}\subseteq S,
\]
is a subring of $S$ with $\widetilde{\widetilde R}=\widetilde R$, i.e. if $s\in S$ is integral over $\widetilde R$, it is integral over $R$.
\end{enumerate}
\end{thm}

\begin{flushright}
\textit{Week 7, lecture 3 starts here}
\end{flushright}

\begin{proof}
\begin{enumerate}
\item If $s_1,\ldots,s_m$ generate $S$ as an $R$-module and $s_1',\ldots,s_n'$ generate $S'$ as an $S$-module, then $\{s_is_j':1\leq i\leq m,\ 1\leq j\leq n\}$ generates $S'$ as an $R$-module. Indeed, if $s\in S'$ then $s=\sum_{i=1}^n a_is_i'$ where $a_i\in S$, and $a_i=\sum_{j=1}^m r_{ij}s_j$ where $r_{ij}\in R$, so
\[
s=\sum_{i=1}^n \left(\sum_{j=1}^m r_{ij}s_j\right)s_i'=\sum_{i=1}^n \sum_{j=1}^m r_{ij} (s_i's_j).
\]
\item We prove by induction on $m$ and Proposition \ref{prop:sintthenRsfinite} provides the base case. Suppose the claim is true for $m'<m$. One has $R[s_1,\ldots,s_m]=R[s_1,\ldots,s_{m-1}][s_m],\ R[s_1,\ldots,s_{m-1}]$ is finite over $R$ and $s_m$ is integral over $R[s_1,\ldots,s_{m-1}]$, so again by Proposition \ref{prop:sintthenRsfinite}, $R[s_1,\ldots,s_m]$ is finite over $R[s_1,\ldots,s_{m-1}]$. Hence by part 1, $R[s_1,\ldots,s_{m}]$ is finite over $R$. To see it is integral, one uses part 3 of Proposition \ref{prop:sintthenRsfinite}.
\item Let $s'\in S'$. One has $s'$ satisfies a relation $s'^n+b_1s'^{n-1}+\cdots+b_n=0$ where $b_i\in S$, so each $b_i$ is integral over $R$. By part 2, $R[b_1,\ldots,b_n]$ is finite over $R$, so by Proposition \ref{prop:sintthenRsfinite}, $R[b_1,\ldots,b_n,s']$ is finite over $R[b_1,\ldots,b_n]$ and so $R[b_1,\ldots,b_n,s']$ is finite over $R$. Therefore again by part 3 of Proposition \ref{prop:sintthenRsfinite}, $s'$ is integral over $R$.
\item To see $\widetilde R$ is a ring, consider $s_1,s_2\in\widetilde R$. Then by part 2, $R[s_1,s_2]$ is integral over $R$, so $-s_1,s_1+s_2,s_1s_2\in R[s_1,s_2]$ are integral over $R$, i.e. in $\widetilde R$. The fact that $\widetilde{\widetilde R}=\widetilde R$ follows from part 3 with $S=\widetilde R,\ S'=\widetilde R[s]$.
\end{enumerate}
\end{proof}

\begin{defn}
$\widetilde R$ is called \textit{integral closure} of $R$ in $S$.

If $\widetilde R=R$ then $R$ is \textit{integrally closed} in $S$.

If $R$ is a domain and is integrally closed in its field of fractions $R_{\la 0\ra}$, then $R$ is \textit{integrally closed} (or \textit{normal}).
\end{defn}

\begin{example}
For $R=\Z$ and $S=\Q\left(\sqrt d\right)$ where $d$ is a squarefree integer, $\widetilde R=\Z[d]$ if $d\equiv 2,3\Mod 4$ and $\Z\left[\frac{1+\sqrt d}{2}\right]$ if $d\equiv 1\Mod 4$. When one sees this, one should recall definition of \textit{ring of integers} in algebraic number theory.

The integral closure of $\C[t^2,t^3]\subseteq \C[t]$ is all of $\C[t]$ since $t$ is integral ($x^2-t^2=0$).
\end{example}

\section{Variety}
\begin{defn}
Let $I\subseteq K[x_1,\ldots,x_n]$ be an ideal where $K$ is a field. The \textit{variety} of $I$ is $V(I):=\{(a_1,\ldots,a_n)\in K^n:f(a_1,\ldots,a_n)=0 \ \forall f\in I\}$.
\end{defn}

\begin{example}
$V(\la x^2+y^2-1 \ra)\subseteq \mathbb R^2$ is a circle, $V(\la y^2-x^3+x-1 \ra)\subseteq \C^2$ is an elliptic curve,  $V(\la xy,xz \ra)\subseteq \C^2$ is $y$-$z$-plane and $x$-axis. 

By Fermat's last theorem, $V(\la x^4+y^4-1\ra)\subseteq \Q^2$ is $\{(0,\pm1),(\pm1,0)\}$.

$V(\la xz-y^2,xw-yz,yw-z^2 \ra)$ is ...
\end{example}

\begin{flushright}
\textit{Week 8, lecture 1 starts here}
\end{flushright}

Note that $(a,b,c,d)\in X\Rightarrow (\lambda a,\lambda b,\lambda c,\lambda d)\in X \ \forall \lambda\in K$. So we look at 2 cases:
\begin{enumerate}
\item[$1^\circ$] $w=0$, then solutions are $\{(a,0,0,0):a\in K\}$.
\item[$2^\circ$] $w=1$, then solutions are $\{(wz^3,wz^2,wz,w):w,z\in K\}$, which is equivalent to

$\{(a^3,a^2b,ab^2,b^3):a,b\in K\}$.
\end{enumerate}

\begin{remark}
Note that by the way we define $V(I),\ I=\la f_1,\ldots,f_r\ra$ is finitely generated by Hilbert. In particular,
\[
V(I)=\left\{ (a_1,\ldots,a_n)\in K^n:f_1(a_1,\ldots,a_n)=\cdots=f_r(a_1,\ldots,a_n) \right\}.
\] 
\end{remark}

\begin{defn}
A field $K$ is \textit{algebraically closed} if $\forall f\in K[x],\ \exists a\in K:f(a)=0$.
\end{defn}
Within context of this module, we assume $K$ to be algebraically closed when talking about varieties.

\begin{defn}
Let $X\subseteq K^n$ be a set. The \textit{ideal} of $X$ is
\[
I(X)=\{f\in K[x_1,\ldots,x_n]:f(a_1,\ldots,a_n)=0 \ \forall (a_1,\ldots,a_n)\in X\}.
\]
\end{defn}

\begin{remark}
One has $X\subseteq V(I(X))$ and $I\subseteq I(V(I))$. Both can be proper, e.g.
\begin{enumerate}
\item $X=\Z\subseteq \C$. Then $V(I(X))=V(\la 0\ra)=\C$.
\item $I=\la x^2\ra\subseteq\C[x]$. Then $I(V(I))=I(\{0\})=\la x\ra$.
\end{enumerate}
\end{remark}

\begin{thm}[Nullstellensatz]
\label{thm:Nullstellensatz}
Let $K$ be algebraically closed and $I\subseteq K[x_1,\ldots,x_n]$.
\begin{enumerate}
\item $V(I)=\varnothing \Leftrightarrow I=\la 1\ra=K[x_1,\ldots,x_n]$.\hfill weak form
\item $I(V(I))=\sqrt I:=\{f:f^m\in I\text{ for some }m\geq 1\}$.\hfill strong form
\end{enumerate}
\end{thm}

\begin{remark}
\begin{enumerate}
\item 2 implies 1, but we will prove it first anyway since it's in fact harder.
\item $K$ must be algebraically closed, e.g. $V(\la x^2+1\ra)\subseteq \mathbb R$ is empty.
\item $\sqrt I$, called the \textit{radical} of $I$, is an ideal. Indeed, if $f,g\in \sqrt I$, then $f^m,g^r\in I$ so
\[
(f+g)^{m+r}=\sum_{k=0}^{m+r}\binom{m+r}{k}f^k g^{m+r-k} \in I,
\]
so $f+g\in\sqrt I$. It's also clear that $\sqrt I$ is multiplicatively closed.

\end{enumerate}
\end{remark}

\begin{flushright}
\textit{Week 8, lecture 2 starts here}
\end{flushright}

\begin{lemma}
$I(X)$ is an ideal.
\end{lemma}
\begin{proof}
If $f(a),g(a)=0 \ \forall a\in X$, then $(f+g)(a)=f(a)+g(a)=0+0=0 \ \forall a\in X$, and $(hf)(a)=h(a)f(a)=h(a)0=0$.
\end{proof}

\begin{prop}
\label{prop:SintRthenRfieldiffSfield}
If $R\subseteq S$ are domains with $S$ integral over $R$, then $R$ is a field iff $S$ is a field.
\end{prop}
\begin{proof}
\begin{itemize}
\item[$\Rightarrow:$] Fix $s\in S$ with $s\neq 0$. Then one can write
\[
s^n+a_1s^{n-1}+\cdots+a_{n-1}s+a_n=0\quad\text{where }a_i\in R
\]
Since $S$ is domain, $a_n\neq 0$, and since $R$ is a field,
\[
1=-a_n^{-1}s\left(s^{n-1}+a_1s^{n-2}+\cdots+a_{n-2}s+a_{n-1}\right),
\]
i.e. $s$ has an inverse, so $S$ is a field.
\item[$\Leftarrow:$] Fix $r\in R$ with $r\neq 0$. Then since $S$ is a field, $r^{-1}\in S$, so one can write
\[
\left(r^{-1}\right)^n+a_1\left(r^{-1}\right)^{n-1}+\cdots+a_{n-1}r^{-1}+a_n=0\quad\text{where }a_i\in R.
\]
Multiplying by $r^{n-1}$ gives
\[
r^{-1}+a_1+\cdots+a_{n-1}r^{n-2}+a_nr^{n-1}=0,
\]
so $r^{-1}\in R$.
\end{itemize}
\end{proof}

\begin{defn}
An $R$-algebra $S$ is \textit{finitely generated} if $\exists s_1,\ldots,s_n\in S:S$ the smallest $R$-subalgebra containing $s_1,\ldots,s_n$.
\end{defn}
\begin{remark}
Finitely generated as an $R$-algebra is \underline{weaker} than finite over $R$ (i.e. finitely generated as an $R$-module), e.g. $K[x_1,\ldots,x_n]$ as a $K$-algebra/module.
\end{remark}

\begin{thm}
Let $K$ be a field and $L$ a finitely generated $K$-algebra which is also a field. Then $L$ is finite over $K$ (in particular integral over $K$).
\end{thm}
\begin{proof}
Write
\[
L=K[x_1,\ldots,x_n]/I\cong K[\overline{x_1},\ldots,\overline{x_n}]\quad\text{where }\overline{x_i}=x_i+I\text{ is the image of }x_i\text{ in }L.
\]
We will prove (by induction) that each $\overline{x_i}$ is integral over $K$, so that by Theorem \ref{thm:integral}.2 we would have the desired.

When $n=1,\ L=K[\overline{x_1}]$. Since $\overline{x_1}^{-1}\in L$, it's a polynomial $p$ in $\overline{x_1}$, so $\ast(\overline{x_1})=\overline{x_1}p(\overline{x_1})-1=0$. Since $K$ is a field, we can make $\ast$ monic and $\overline{x_1}$ is hence integral over $K$, so $L$ is finite over $K$.

Now suppose the statement is true for $n-1$. Since $L$ is a field, it contains the field $K(\overline{x_1})$, so we can really think of $L$ as $K(\overline{x_1})[\overline{x_2},\ldots,\overline{x_{n-1}}]$. By induction hypothesis, $L$ is finite over $K(\overline{x_1})$, so each $\overline{x_j}$ where $2\leq j\leq n$ is integral over $K(\overline{x_1})$, i.e. one has a monic polynomial $p_j\in K(\overline{x_1})[x]:p_j(\overline{x_j})=0$. Let $f\in K[\overline{x_1}]$ be a common denominator of coefficients of all $p_j$. Then one can see $p_j$ as monic with coefficients in $K[\overline{x_1}][f^{-1}]$, and $L$ is integral over $K[\overline{x_1}][f^{-1}]$. By Proposition \ref{prop:SintRthenRfieldiffSfield}, $K[\overline{x_1}][f^{-1}]\subseteq K(\overline{x_1})$ is a field. By minimality of $K(\overline{x_1}),\ K[\overline{x_1}][f^{-1}]\cong K(\overline{x_1})$.

\begin{flushright}
\textit{Week 8, lecture 3 starts here}
\end{flushright}

Consider the ring homomorphism $\varphi:K[t]\rightarrow K[\overline{x_1}]:t\mapsto \overline{x_1}$. This is surjective by construction. If $\varphi$ is injective (hence an isomorphism), then $K(t)\cong K(\overline{x_1})$. Let $p(t)=\varphi^{-1}(f)$ and choose $g\in K[t]$ with $p\nmid g$. Then
\[
\frac{1}{q}\notin K[t][p^{-1}]\cong K[\overline{x_1}][f^{-1}]\cong K(\overline{x_1})\cong K(t),
\]
a contradiction, so $\varphi$ is not injective, i.e. $\exists p\in K[t]:p(\overline{x_1})=0$. Again, since $K$ is a field, one can make $p$ monic and see that $\overline{x_1}$ is integral over $K$, so $K[\overline{x_1}]$ is finite over $K$. Now by \ref{prop:SintRthenRfieldiffSfield}, $K[\overline{x_1}]$ is a field and so $K[\overline{x_1}]\cong K(\overline{x_1})$, hence $K(\overline{x_1})$ is finite over $K$. We conclude that $L$ is finite over $K$.
\end{proof}

\begin{coro}
The maximal ideals of $K[x_1,\ldots,x_n]$ where $K$ is an algebraically closed field are of the form $\la x_1-a_1,\ldots,x_n-a_n\ra$ where $a_i\in K$.
\end{coro}
\begin{remark}
\begin{enumerate}
\item Again we do need the assumption of $K$ being algebraically closed. Consider $\la x^2+1\ra\subseteq \mathbb R[x]$, which is maximal since any ideal strictly containing it would be generated by something that strictly divides $x^2+1$, which is however irreducible over $\mathbb R$.
\item If $K$ is algebraically closed then there are no fields $L\supsetneqq K$ with $L$ finite over $K$, since if there is such $L$ then $l\in L\backslash K$ would satisfy a monic polynomial with coefficients in $K$ and minimal degree, but then by definition $l\in K$.
\end{enumerate}
\end{remark}
\begin{proof}
Let $\m$ be a maximal ideal. Then $L=K[x_1,\ldots,x_n]/\m$, a finitely generated $K$-algebra, is a field, so by theorem above $L$ is finite over $K$. Since $K$ is algebraically closed, by remark above $L\cong K$, i.e. $\exists\varphi:K[x_1,\ldots,x_n]/\m\rightarrow K$ with $\varphi(a)=a\ \forall a\in K$. Set $a_i=\varphi(x_i)$, then $\varphi(x_i-a_i)=\varphi(x_i)-a_i=0$, i.e. $x_i-a_i\in\ker\varphi=\m$, so $\m\supseteq\la x_1-a_1,\ldots,x_n-a_n\ra$. We claim
\[
f\in\m\backslash\la x_1-a_1,\ldots,x_n-a_n\ra \Rightarrow f(a_1,\ldots,a_n)\in\m,
\]
proof of which is left as an exercise. This completes the proof.
\end{proof}

We are now ready to prove the \textbf{Nullstellensatz}.
\begin{proof}[Proof of \ref{thm:Nullstellensatz}]
\begin{enumerate}
\item Suppose $I\subsetneqq K[x_1,\ldots,x_n]$. Then $I\subseteq \m$ for some maximal ideal $\m=\la x_1-a_1,\ldots,x_n-a_n\ra$. One has $I\subseteq J\Rightarrow V(J)\subseteq V(I)$, so since $(a_1,\ldots,a_n)\in V(\m),\ V(I)\neq\varnothing$.
\item (by Rabinowitch trick) Note that if $f^m\in I$ then $f^m(a)=0 \ \forall a\in V(I)$, so $(f(a))^m=0$ and so $f(a)=0 \ \forall a\in V(I)$, so $f\in I(V(I))$. We have just proved that $\sqrt I\subseteq I(V(I))$.

Now fix $f\in I(V(I))$ and set $J=\la f_1,\ldots,f_r, yf-1\ra\subseteq K[x_1,\ldots,x_n,y]$ where $f_i$ are generators of $I$ (one can write down this since $K[x_1,\ldots,x_n]$ is Noetherian). One has $V(J)=\varnothing$ since $f$ and $fy-1$ cannot be zero at the same time. By weak Nullstellensatz, $1\in J$, i.e.
\[
1=\sum_{i=1}^r h_i(x,y)f_i(x) + h(x,y)(yf-1)\in K[x_1,\ldots,x_n,y]\subseteq K(x_1,\ldots,x_n,y).
\]
Now if one just lets $y=\frac{1}{f}$ then
\[
1=\sum_{i=1}^r h_i\left(x,\frac1f\right) f_i(x)
\]
and for some $m$ one can clear the denominators and have
\[
f^m=\sum_{i=1}^r \underbrace{h_i\left(x,\frac1f\right)f^m}_{\text{polynomial in }x} f_i(x) \in I,
\]
i.e. $I(V(I))\subseteq \sqrt I$.
\end{enumerate}
\end{proof}

\begin{flushright}
\textit{Week 9, lecture 1 starts here}
\end{flushright}

\begin{example}
$\sqrt I$ where $I=\la n\ra\subseteq\Z$ is $\la m\ra$ where $m$ is the `squarefree part of $n$', i.e. if $n=72=2^3\times 3^2$ then $m=2\times 3=6$, and if $n=8=2^3$ then $m=2$.
\end{example}

\section{Primary decomposition}
\begin{remark}
Recall
\begin{enumerate}
\item Any positive integer has a unique prime factorisation $n=p_1^{m_1}p_2^{m_2}\cdots p_r^{m_r}$ where $p_i$ are prime and $m_i\in\mathbb N$.
\item If $R$ is a UFD then every $f\in R$ can be written uniquely as a product of powers of irreducible elements
\[
f=\prod_{i=1}^s f_i^{m_i}\qquad \text{(meaning) } \la f\ra=\bigcap_{i=1}^s \la f_i^{m_i}\ra
\]
where $f_i$ are irreducible and $m_i\in\mathbb N$, up to unit.

Note that in this case,
\item \[
V(\la f\ra)=\bigcup_{i=1}^s V(f_i^{m_i})=\bigcup_{i=1}^s V(f_i).
\]

\textbf{In general}, $I=J_1\cap J_2\Rightarrow V(I)=V(J_1)\cup V(J_2)$.
\begin{proof}
One has $J_1\cap J_2\subseteq J_1$ and so by definition $V(J_1)\subseteq V(J_1\cap J_2)=V(I)$ and similarly $V(J_2)\subseteq V(J_1\cap J_2)=V(I)$ and one has $V(J_1)\cup V(J_2)\subseteq V(I)$.

Conversely, $J_1\cap J_2\supseteq J_1J_2=\la fg:f\in J_1,g\in J_2\ra$, so $V(I)=V(J_1\cap J_2)\subseteq V(J_1J_2)$. If $x\in V(J_1J_2)\backslash V(J_1)$ then $(fg)(x)=0 \ \forall g\in J_2$ and $\exists f\in J_1:f(x)\neq 0$, but then $x\in V(J_2)$, so $V(J_1J_2)\subseteq V(J_1)\cup V(J_2)$.
\end{proof}

We want to do things like this in more generality in this chapter.
\end{enumerate}
\end{remark}

\begin{defn}
Let $Q$ be a proper ideal in a ring $R.\ Q$ is \textit{primary} if $fg\in Q\Rightarrow f\in Q$ or $g^m\in Q$ for some $m\in\mathbb N$.
\end{defn}
\begin{example}
$\la27\ra\subseteq\Z$ is primary since if $nm\in\la27\ra$ then $27\mid nm$ so either $27\mid n$ or $3\mid m$ (so $27\mid m^3$). In fact, primary ideals in $\Z$ are generated by powers of primes.
\end{example}

Note that if $Q$ is primary then $\sqrt Q$ is prime. Indeed, if $fg\in\sqrt Q$ then $(fg)^n=f^ng^n\in Q$ for some $n>0$, so either $f^n\in Q$ (so $f\in\sqrt Q$) or $g^{nm}\in Q$ (so $g\in\sqrt Q$).

\begin{flushright}
\textit{Week 9, lecture 2 starts here}
\end{flushright}

\begin{remark}[$\lightning$]
There are ideals $Q$ with $\sqrt Q=P$ prime, but $Q$ not primary, e.g. $Q=\la x^2,xy\ra\subseteq\C[x,y]$ is not primary since $xy\in Q$ but $x\notin Q$ since $x$ is not divisible by $x^2$ or $xy$ and $y^m\notin Q$ (note this argument only works for monomial ideals). But $\sqrt Q=\la x\ra$ is prime, since $\C[x,y]/\la x\ra\cong\C[y]$, a domain.
\end{remark}

For the rest of this topic, we will assume $R$ is Noetherian.

\begin{defn}
Let $I$ be a proper ideal in ring $R$. A \textit{primary decomposition} of $I$ is an expression
\[
I=Q_1\cap \cdots \cap Q_r\quad\text{where each }Q_i\text{ is primary}.
\]
The decomposition is \textit{irredundant} if we can't remove any $Q_i$, i.e.
\[
I\subsetneq \bigcap_{i\neq j}Q_i .
\]
The decomposition is \textit{minimal} if there's no decomposition with fewer terms, i.e. $r$ is minimal.
\end{defn}

\begin{example}
\begin{enumerate}
\item $\la 12\ra=\la 3\ra\cap\la 4\ra$. This is a primary decomposition that's irredundant and minimal (since $\la 12\ra$ is no primary).
\item $I=\la x^2,xy,x^2 z^2,yz^2\ra=\la x^2,y\ra\cap\la x,z^2\ra$. Note that the radicals
\[
\sqrt{\la x^2,y\ra}=\la x,y\ra,\quad \sqrt{\la x,z^2\ra}=\la x,z\ra
\]
are prime. We claim they are actually primary, so we've got a primary decomposition. Again this is irredundant and minimal since $xy\in I$ but $x\notin I$ and $y^m\notin I \ \forall m\in\mathbb N$.
\end{enumerate}
\end{example}

\begin{exe}
\begin{enumerate}
\item Is $\la x^2\ra\cap\la y^3\ra\cap\la x,y\ra=\la x^2 y^3\ra$ a primary decomposition? Irredundant? Minimal?

Indeed $\la x^2\ra$ is primary (since $x^2\mid fg\Rightarrow x^2\mid f$ or $x\mid g$ so $x^2\mid g^2$), $\la y^3\ra$ is primary (similar) and $\la x,y\ra$ is maximal so prime so primary. It's not irredundant since one can remove $\la x,y\ra$, so as a result it's not minimal.
\item Verify the two ideals in above example are primary.
\end{enumerate}
\end{exe}

\begin{defn}
A proper ideal $I\subseteq R$ is \textit{irreducible} if it cannot be written as intersection of 2 strictly large ideals, i.e. $I=J\cap K,\ J,K$ ideals of $R \Rightarrow I=J$ or $K$.
\end{defn}

\begin{example}
\begin{enumerate}
\item In $\Z,\ \la 5\ra,\la 25\ra$ are irreducible and $\la 6\ra=\la 2\ra\la 3\ra$ is.
\item $\la xy\ra=\la x\ra\cap\la y\ra\subseteq\C[x,y]$ is not irreducible, but $\la x^2,y^2\ra$ is.
\end{enumerate}
\end{example}

\begin{lemma}
Irreducible ideals in ring $R$ are primary.
\end{lemma}
\begin{proof}
Let $I\subseteq R$ be irreducible with $fg\in I$. Consider chain of ideals
\[
J_1\subseteq J_2\subseteq J_3\subseteq \cdots
\]
where
\[
J_m=(I:g^m):=\{h\in R:hg^m\in I \ \text{ for }m\geq 1\}.
\]
This must stabilise since $R$ is Noetherian, i.e. $\exists N:J_m=J_N \ \forall m\geq N$. We claim that
\[
I=\left(I+\la g^N\ra\right)\cap (I+\la f\ra).
\]
The $\subseteq$ inclusion is clear. Now fix $h\in\left(I+\la g^N\ra\right)\cap (I+\la f\ra)$. Then $gh\in I$ since $h\in I+\la f\ra$ and $fg\in I$. Also one can write $h=i+rg^N$ for some $i\in I,\ r\in R$, so $gh=gi+rg^{N+1} \in I$, hence $rg^{N+1}\in I$, i.e. $r\in (I:g^{N+1})=(I:g^N)$. Thus $rg^N\in I$ and so $h\in I$.

Since $I$ is irreducible, $I=I+\la g^N\ra$ or $I+\la f\ra$, which precisely implies that $I$ is primary.
\end{proof}

\begin{flushright}
\textit{Week 9, lecture 3 starts here}
\end{flushright}

\begin{thm}
All proper ideals of a ring $R$ have a primary decomposition.
\end{thm}
\begin{proof}[Proof by Noetherian induction]
By lemma above, it suffices to show every proper ideal is intersection of finitely many irreducibles. Let $S$ by the set of proper ideals that is not such intersection and we want to show $S=\varnothing$. Suppose not, then $S$ has a maximal element $I$ since $R$ is Noetherian. Then $I$ is not irreducible, and so one can write $I=J\cap K$ for strictly larger ideals $J,K\notin S$. Hence one has write irreducible decompositions for both $J,K$ and therefore one for $I$, a contradiction.
\end{proof}

\begin{example}[Primary ideals are not necessarily irreducible]
Consider $I=\la x^2,xy,y^2\ra\subseteq \C[x,y]$. If $fg\in I$ and $f,g$ are homogeneous, then $\deg fg\geq 2$ so either $\deg f\geq 2$ which means $f\in I$ or $\deg g\geq 1$ so $g^2\in I$, so $I$ is primary, so it is a irredundant primary decomposition of itself. But also $I=\la x^2,y\ra\cap\la x,y^2\ra$ is also a irredundant decomposition. Note that radicals of both are $\la x,y\ra$, which is not an accident.
\end{example}

\begin{lemma}
If $Q_1,Q_2$ are primary ideals in $R$ with $\sqrt{Q_1}=\sqrt{Q_2}=P$ then $Q_1\cap Q_2$ is $P$-primary.
\end{lemma}
\begin{proof}
Let $fg\in Q_1\cap Q_2$. Then either $f\in Q_1\cap Q_2$ or WLOG $f\notin Q_1$. Since $Q_1$ is primary, $g^m\in Q_1$ for some $m>0$, so $g\in\sqrt{Q_1}=\sqrt{Q_2}$ and so $g^l\in Q_2$ for some $l>0$, thus $g^{\max(m,l)}\in Q_1\cap Q_2$, hence $Q_1\cap Q_2$ is primary.

Now $Q_1\cap Q_2\subseteq Q_1\Rightarrow \sqrt{Q_1\cap Q_2}\subseteq \sqrt{Q_1}=P$. If $f\in P$ then $f^m\in Q_1$ and $f^l\in Q_2$ for some $m,l>0$, so $f^{\max(m,l)}\in Q_1\cap Q_2$, thus $P\subseteq\sqrt{Q_1\cap Q_2}$. One concludes $\sqrt{Q_1\cap Q_2}=P$. 
\end{proof}
This means we can just take intersection of two primary ideals with same radical in our decomposition to get a shorter one. The next goal is to show that after this `shortening', the $\sqrt{Q_i}$ are determined.

\begin{defn}
Let $M$ be an $R$-module. An ideal $P$ is an \textit{associated prime} of $M$ if $P$ is prime and $P=\ann(m)$ for some $m\in M$. We write $\ass(M)$ for set of associated primes of $M$.
\end{defn}
\begin{example}
$\la 3\ra$ is an associated prime of the $\Z$-module $\Z/27\Z$; in fact it's the only one, i.e. $\ass(M)=\{\la3\ra\}$.
\end{example}

\begin{flushright}
\textit{Week 10, lecture 1 starts here}
\end{flushright}

\begin{lemma}
\label{nzeromoduleshavenemptyass}
If $R$ is Noetherian and $M\neq 0$, then $\ass(M)\neq\varnothing$. 
\end{lemma}
\begin{proof}
Let $S=\{\ann(m):m\in M,m\neq 0\}$. Then $S$ is nonempty since $M\neq 0$. Every element of $S$ is proper, since $1\notin\ann(m)$ if $m\neq 0$. $S$ therefore has a maximal element $I=\ann(m')$ since $R$ is Noetherian. We claim $I$ is prime. Indeed, if $fg\in I$ then $fgm'=0$. If $gm'=0$ then $g\in I$. Otherwise, $gm'\neq 0$ and $f\in\ann (gm')\in S$. It's clear that $\ann(m')\subseteq\ann(gm')$, but since $\ann(m')$ is maximal, it must be $\ann(m')=\ann(gm')$ and $f\in\ann(m')$, so $I$ is prime, hence an associated prime.
\end{proof}

\begin{prop}
\label{prop:assRQ=P}
If $Q$ is $P$-primary in a Noetherian ring $R$, then $\ass(R/Q)=\{P\}$.
\end{prop}
\begin{proof}
We have $\sqrt Q=P$. If $r\in R\backslash Q$ and $s\in R$ with $rs\in Q$, then $s^l\in Q$ for some $l>0$, so $s\in P$. Thus for any $0\neq m=r+Q\in R/Q$, one has $\ann(m)\subseteq P$. Since $Q\subseteq\ann(m)$, one has $P=\sqrt Q\subseteq \sqrt{\ann(m)}\subseteq \sqrt P=P$, so $\sqrt{\ann(m)}=P$. This means if $\ann(m)$ is prime then it's $P$, i.e. $\ass(R/Q)\subseteq\{P\}$. The other inclusion is clear, so $\ass(R/Q)=\{P\}$.
\end{proof}

\begin{example}
$\displaystyle \ass\left(\frac{\C[x,y]}{\la x^2,y\ra}\right)=\{\la x,y\ra\}$ since $\la x^2,y\ra$ is $\la x,y\ra$-primary.
\end{example}

\begin{thm}
Let $R$ be Noetherian and $I=Q_1\cap \cdots \cap Q_s$ be a primary decomposition where $Q_i$ is $P_i$-primary. Then $\ass(R/I)\subseteq\{P_1,\ldots,P_s\}$. If the decomposition is irredundant then one has equality.

This gives us a way to get a minimal primary decomposition from any decomposition.
\end{thm}

\begin{lemma}
\label{lemma:injthenasssubset}
If $\varphi:M\rightarrow N$ is injective then $\ass(M)\subseteq\ass(N)$.
\end{lemma}
\begin{proof}
$\ann(m)=\ann(\varphi(m))$, since if $rm=0_M$ then $0_N=\varphi(rm)=r\varphi(m)$ so $\ann(m)\subseteq \ann(\varphi(m))$ and if $r\varphi(m)=0_N$ then $\varphi(rm)=0_N$, so since $\varphi$ is injective $rm=0_M$, i.e. $r\in\ann(m)$, so $\ann(m)\supseteq \ann(\varphi(m))$.
\end{proof}
\begin{example}
One can indeed has proper inclusion, e.g. $R=\Z,\ N=\Z/6\Z,\ M=\Z/3\Z$ with $\varphi:M\rightarrow N:m\mapsto 2m$. Then $\ass(N)=\{\la 2\ra, \la 3\ra\}$ and $\ass(M)=\{\la 3\ra\}$.
\end{example}

\begin{flushright}
\textit{Week 10, lecture 2 starts here}
\end{flushright}

\begin{defn}
If $M_1,\ldots,M_s$ are $R$-modules, then $\bigoplus_{i=1}^s R_i$ is an $R$-module with elements $(m_1,\ldots,m_s)$ where $m_i\in M_i$, coordinatewise addition and multiplication defined $r(m_1,\ldots,m_s)=(rm_1,\ldots,rm_s)$.
\end{defn}
\begin{example}
$R^n=\bigoplus_{i=1}^n R$

$R=\Z,\ \Z/2\Z \times \Z/3\Z=\Z/2\Z \oplus \Z/3\Z=\Z/6\Z$.
\end{example}

\begin{lemma}
If $M=\bigoplus_{i=1}^s M_i$ then $\ass(M)=\bigcup_{i=1}^s \ass (M_i)$.
\end{lemma}
\begin{proof}
We have injective homomorphisms
\[
\begin{aligned}
\varphi_i:M_i&\rightarrow M\\
m_i&\mapsto(0,\ldots,&m_i,\ldots,0)\\
&&i\text{th position}
\end{aligned}
\]
Thus by \ref{lemma:injthenasssubset}, $\ass(M_i)\subseteq\ass(M) \ \forall i$, i.e. $\bigcup_{i=1}^s \ass (M_i)\subseteq \ass(M)$.

For the other inclusion, we prove by induction on $s$. The base case is a tautology, now suppose the statement is true for $s-1$, and let $P=\ann((m_1,\ldots,m_s))\in\ass(M)$. Suppose for contradiction $P\notin\ass(M_i)$ for any $i$. Note that for all $r\in P,\ rm_s=0_{M_s}$. Since $P\neq\ann(m_s)$by assumption, there is an $r'\in\ann(m_s)\backslash P$. By induction, $P\notin\ass\left(\bigoplus_{i=1}^{s-1} M_i\right)$, so $P\neq \ann((m_1,\ldots,m_{s-1}))$. Thus there is an $r''\in R\backslash P$ with $r''(m_1,\ldots,m_{s-1})=0_{\bigoplus_{i=1}^{s-1} M_i}$. Then $r'r''(m_1,\ldots,m_s)=0$, i.e. $r'r''\in P$. But $P$ is prime, a contradiction.
\end{proof}

\begin{example}
By lemma above and Proposition \ref{prop:assRQ=P},
\[
\begin{aligned}
\ass(\Z/2\Z\oplus\Z/4\Z\oplus\Z/3\Z)&=\ass(\Z/2\Z)\cup\ass(\Z/4\Z)\cup\ass(\Z/3\Z)\\
&=\{\la 2\ra\}\cup\{\la 2\ra\}\cup\{\la 3\ra\}\\
&=\{\la 2\ra,\la 3\ra\}.
\end{aligned}
\]
\end{example}

\begin{thm}
Let $R$ be Noetherian and $I=Q_1\cap\cdots\cap Q_s$ a primary decomposition with $Q_i \ P$-primary. Then
\[
\ass(R/I)\subseteq \{P_1,\ldots,P_s\}
\]
and if the decomposition is irredundant then one has equality.
\end{thm}

\begin{proof}
Each $R/Q_i$ is an $R$-module, so we can form the direct sum $M=\bigoplus_{i=1}^s R/Q_i$. Consider the $R$-module homomorphism
\[
\begin{aligned}
\varphi:R/I&\rightarrow M\\
r+I&\mapsto (r+Q_1,\ldots,r+Q_s)
\end{aligned}
\]
This is well defined, since if $r+I=r'+I$ then $r-r'\in I\subseteq Q_i$ for all $i$, so $r+Q_i=r'+Q_i$ for all $i$. This is injective, since $\varphi(r+I)=0$ implies $r\in Q_i$ for all $i$, i.e. $r\in\bigcap_{i=1}^s Q_i=I$. Thus by lemmas above,
\[
\ass(R/I)\subseteq\ass(M)=\bigcup_{i=1}^s \ass (R/Q_i)=\{P_1,\ldots,P_s\}.
\]
If the decomposition is irredundant, then for all $i,\ I\subsetneqq \bigcap_{j\neq i}Q_j$. Consider $0\neq \bigcap_{j\neq i} Q_j+I\subseteq R/I$ and $\varphi\left(\bigcap_{j\neq i} Q_j+I\right)$. Since $\varphi$ is injective, this is nonzero, but the $j$th coordinates are zero where $j\neq i$. So $\varphi|_{\bigcap_{j\neq i} Q_j+I}$ is an injective homomorphism to $R/Q_i$. Thus
\[
\ass\left(\bigcap_{j\neq i} Q_j+I\right)\subseteq \ass (R/Q_i)=\{P_i\}.
\]
Since $\ass\left(\bigcap_{j\neq i} Q_j+I\right)$ is nonempty by \ref{nzeromoduleshavenemptyass}, it's $\{P_i\}$. Now since
\[
\begin{aligned}
\bigcap_{j\neq i} Q_j+I&\hookrightarrow R/I\\
r+I&\mapsto r+I
\end{aligned}
\]
is injective,
\[
\ass\left(\bigcap_{j\neq i} Q_j+I\right)\subseteq \ass(R/I),
\]
so $P_i\in\ass(R/I)$ for all $i$, i.e. $\{P_1,\ldots,P_s\}\subseteq \ass(R/I)$.
\end{proof}

\begin{flushright}
\textit{Week 10, lecture 3 starts here}
\end{flushright}

\begin{defn}
An associated prime $P$ of an $R$-module $M$ is \textit{minimal} if there is no $P'\subseteq P$ with $P'\in\ass(M)$.
\end{defn}
\begin{example}
$\la x\ra\cap \la x^2,y\ra =I=\la x^2,xy\ra \subseteq \C[x,y]=R$. Then $\ass(R/I)=\{\la x\ra,\la x,y\ra\}$ where $\la x\ra$ is minimal and $\la x,y\ra$ is not.
\end{example}

\begin{defn}
If $I=\bigcap Q_j$ is an irredundant primary decomposition with $\sqrt{Q_i}\neq \sqrt{Q_j}$ for $i\neq j$, then $Q_i$ is called the \textit{primary component} of $I$ corresponding to $P_i=\sqrt{Q_i}$.
\end{defn}

\begin{prop}
Let $P$ be a minimal associated prime of an ideal $I$ in a Noetherian ring $R$. Then the $P$-primary component of $I$ does not depend on the choice of primary decomposition.
\end{prop}

\begin{proof}
Let $I=\bigcap_{i=1}^s Q_i$ be an irredundant primary decomposition with $\sqrt{Q_i}\neq\sqrt{Q_j}$ for $i\neq j$, and $\sqrt{Q_s}=P$. Since $\bigcap_{i=1}^{s-1} Q_i\neq I$, there is $f\in \bigcap_{i=1}^{s-1} Q_i\backslash Q_s$. We may also assume $f\notin P$ since if $\bigcap_{i=1}^{s-1} Q_i\subseteq P$, then $Q_i\subseteq P$ for some $i$, so $\sqrt{Q_i}\subseteq P$ for some $i$, contradicting minimality. Then $(I:f^\infty)=\bigcap_{i=1}^s (Q_i:f^\infty)$. If $f\in Q_i$ then $(Q_i:f^\infty)=R$ since $1f\in Q_i$, so $(I:f^\infty)=(Q_s:f^\infty)$. If $g\in(Q_s:f^\infty)$ then $gf^m\in Q_s$ for some $m\geq 0$. Since $Q_s$ is primary, either $g\in Q_s$ or $(f^m)^l\in Q_s\subseteq P$ for some $l$, but then $f\in P$, so $g\in Q_s$, thus $(I:f^\infty)=(Q_s:f^\infty)=Q_s$.
\end{proof}

\begin{remark}
The minimality assumption was essential. Consider $I=\la x^2\ra\cap\la x^3,y^2\ra=\la x^2\ra\cap \la x^3,x^2y^2,y^3\ra=\la x^3,x^2y^2\ra\subseteq \C[x,y]$.
\end{remark}

\end{document}
